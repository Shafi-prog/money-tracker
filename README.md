# ๐ฏ SJA MoneyTracker V2.1

> **ูุธุงู ุฐูู ูุญุณูู ูุชุชุจุน ุงููุตุฑููุงุช ุชููุงุฆูุงู ูุน ุชุชุจุน ุงูุฃุฑุตุฏุฉ ูุงูุฏููู**

[![Google Apps Script](https://img.shields.io/badge/Google%20Apps%20Script-โ-green.svg)](https://script.google.com)
[![Telegram Bot](https://img.shields.io/badge/Telegram-Bot%20API-blue.svg)](https://telegram.org)
[![Groq AI](https://img.shields.io/badge/AI-Groq%20Llama%203.3-purple.svg)](https://groq.com)
[![Version](https://img.shields.io/badge/version-2.1-blue.svg)]()
[![Status](https://img.shields.io/badge/status-production%20ready-brightgreen.svg)]()

---

## ๐ ููุฑุฉ ุงููุธุงู

ูุธุงู **SJA MoneyTracker** ูุญู ูุดููุฉ ุฃุณุงุณูุฉ: **ุชุชุจุน ุงููุตุฑููุงุช ุชููุงุฆูุงู ุจุฏูู ุฅุฏุฎุงู ูุฏูู**.

### ๐ฏ ุงููุฏู ุงูุฑุฆูุณู
ุนูุฏ ุงุณุชูุงู ุฑุณุงูุฉ SMS ูู ุงูุจููุ ูุชู:
1. **ุงุณุชุฎุฑุงุฌ ุงูุจูุงูุงุช** (ุงููุจูุบุ ุงูุชุงุฌุฑุ ุงูุชุงุฑูุฎ)
2. **ุชุตููู ุฐูู** ุจุงูู AI (Groq Llama 3.3)
3. **ุชุญุฏูุซ ุงูุฑุตูุฏ** ุชููุงุฆูุงู
4. **ุฅุฑุณุงู ุฅุดุนุงุฑ** ุนุจุฑ Telegram
5. **ุชุชุจุน ุงูุฏููู** ุฅุฐุง ูุงูุช ุญูุงูุฉ ูุดุฎุต

---

## ๐ฑ ููู ูุนูู ุงููุธุงูุ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                         ๐ฑ iPhone                                โ
โ   SMS ูู ุงูุจูู โ iPhone Shortcuts โ HTTP POST to GAS            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    โก Google Apps Script                         โ
โ                                                                  โ
โ   Ingress.js     โ  Queue.js      โ  Flow.js                    โ
โ   (ุงุณุชูุจุงู)         (ุทุงุจูุฑ)          (ูุนุงูุฌุฉ)                    โ
โ                                                                  โ
โ        โ               โ               โ                        โ
โ   Auth Check      Lock Service     AI.js                        โ
โ   Dedup Check                      (Groq API)                   โ
โ                                                                  โ
โ                         โ                                        โ
โ              saveTransaction()                                   โ
โ   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ                โ
โ   โ โข Sheet1: ุชุณุฌูู ุงููุนุงููุฉ                   โ                โ
โ   โ โข Budgets: ุชุญุฏูุซ ุงูููุฒุงููุฉ                 โ                โ
โ   โ โข Accounts: ุชุญุฏูุซ ุงูุฑุตูุฏ                   โ                โ
โ   โ โข Debt_Index: ุชุชุจุน ุงูุฏููู                  โ                โ
โ   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ                โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                      ๐ฒ Telegram                                 โ
โ                                                                  โ
โ   โ ๐ณ ุฑุตุฏ ูุงูู | ุนูููุฉ                                        โ
โ   โโโโโโโโโโโโโโ                                                โ
โ   ๐ 26/1/25 โข ๐ฆ ุณุงุจ                                           โ
โ   ๐ฐ 239.05 SAR โฌ๏ธ                                              โ
โ   ๐ช MADFU                                                       โ
โ   ๐ท๏ธ ูุดุชุฑูุงุช ุนุงูุฉ                                               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## โจ ุงููููุฒุงุช ุงูุฑุฆูุณูุฉ

### ๐ฆ 1. ุชุญููู ุฑุณุงุฆู SMS
| ุงูุจูู | ุงูุฏูุฉ | ุงูุญุงูุฉ |
|-------|-------|--------|
| ุณุงุจ SAIB | 95%+ | โ |
| ูุตุฑู ุงูุฑุงุฌุญู | 95%+ | โ |
| tiqmo | 95%+ | โ |
| Tamara | 95%+ | โ |

### ๐ค 2. ุชุตููู ุฐูู ุจุงูู AI
- **Groq Llama 3.3** ููุญุฑู ุฃุณุงุณู
- **Gemini** ูุงุญุชูุงุทู
- **Fallback ูุญูู** ุฅุฐุง ูู ุชุชููุฑ API

### ๐ฐ 3. ุชุชุจุน ุงูุฃุฑุตุฏุฉ ุงูุชููุงุฆู
- **ุชุญุฏูุซ ุชููุงุฆู** ุจุนุฏ ูู ุนูููุฉ
- **ุนุฑุถ ูู Telegram** ูุน ูู ุฅุดุนุงุฑ
- **ุชุนุฏูู ูุฏูู** ูู ุงููุงุฌูุฉ

### ๐ค 4. ูุธุงู ุชุชุจุน ุงูุฏููู
| ุงูุญุงูุฉ | ุงููุซุงู | ุงูุณุฌู |
|--------|--------|-------|
| ุฃูุฑุถุช ุดุฎุต | ุฏูุนุช 500 ูู "ูุญูุฏ" | ูุญูุฏ ูุฏูู ูู +500 |
| ุณุฏุฏ ูู | ูุญูุฏ ุญููู ูู 500 | ูุญูุฏ ูุฏูู ูู 0 (ุชู ุงูุชุณุฏูุฏ) |
| ุงุณุชููุช | ุฃุญูุฏ ุฃุนุทุงู 200 | ุฃูุช ุชุฏูู ูู ุฃุญูุฏ -200 |

### ๐ฒ 5. ุฃูุงูุฑ Telegram
| ุงูุฃูุฑ | ุงููุธููุฉ |
|-------|---------|
| `/start` | ๐ ุจุฏุก ุงูุจูุช |
| `/today` | ๐ ุชูุฑูุฑ ุงูููู |
| `/week` | ๐๏ธ ุชูุฑูุฑ ุงูุฃุณุจูุน |
| `/month` | ๐๏ธ ุชูุฑูุฑ ุงูุดูุฑ |
| `/budgets` | ๐ ููุฎุต ุงูููุฒุงููุงุช |
| `/balances` | ๐ณ ุฃุฑุตุฏุฉ ุงูุญุณุงุจุงุช |
| `/last` | ๐งพ ุขุฎุฑ 5 ุนูููุงุช |
| `/search ูููุฉ` | ๐ ุจุญุซ |
| `/add ูุจูุบ\|ุฌูุฉ\|ุชุตููู` | โ ุฅุฏุฎุงู ูุฏูู |
| `/help` | โ ูุณุงุนุฏุฉ |

### ๐ 6. ูุงุฌูุฉ ููุจ ูุชูุงููุฉ
- **ููุญุฉ ุชุญูู** ุจุฅุญุตุงุฆูุงุช ููุฑูุฉ
- **ุฅุฏุงุฑุฉ ุงููุนุงููุงุช** (ุชุนุฏูู/ุญุฐู)
- **ุฅุฏุงุฑุฉ ุงูููุฒุงููุงุช** 
- **ุฅุฏุงุฑุฉ ุงูุญุณุงุจุงุช** ูุน ุชุญุฏูุซ ุงูุฃุฑุตุฏุฉ
- **ุชูุงุฑูุฑ** ููููุฉ/ุฃุณุจูุนูุฉ/ุดูุฑูุฉ

---

## ๐ก๏ธ ุงูุฃูุงู ูุงูุญูุงูุฉ

| ุงูููุฒุฉ | ุงููุตู |
|--------|-------|
| **INGRESS_SECRET** | ูุตุงุฏูุฉ SMS Webhook |
| **TG_SECRET_TOKEN** | ูุตุงุฏูุฉ Telegram |
| **Input Sanitization** | ุชูุธูู ุงููุฏุฎูุงุช ูู HTML/XSS |
| **Rate Limiting** | ุญูุงูุฉ ูู ุงูุทูุจุงุช ุงููุซูุฑุฉ |
| **Dedup Cache** | ููุน ุชูุฑุงุฑ ุงููุนุงููุงุช |
| **LockService** | ููุน race conditions |
| **API Key Sanitization** | ุฅุฎูุงุก ุงูููุงุชูุญ ูู ุงูุณุฌูุงุช |

---

## ๐ ุงูุชุซุจูุช ูุงูุฅุนุฏุงุฏ

### ุงููุชุทูุจุงุช
```
โ ุญุณุงุจ Google
โ Telegram Bot Token (ูู @BotFather)
โ Groq API Key (ูุฌุงูู ูู groq.com)
โ iPhone ูุน ุชุทุจูู Shortcuts
```

### ุงูุฎุทูุฉ 1: ุฅุนุฏุงุฏ Google Apps Script
```bash
# ุงุณุชูุณุงุฎ ุงููุดุฑูุน
git clone https://github.com/your-repo/money-tracker.git
cd money-tracker

# ุชุซุจูุช clasp
npm install -g @google/clasp

# ุชุณุฌูู ุงูุฏุฎูู
clasp login

# ุฑูุน ุงููููุงุช
clasp push
```

### ุงูุฎุทูุฉ 2: ุฅุนุฏุงุฏ Script Properties
ุงุฐูุจ ุฅูู **Apps Script Editor** โ **Project Settings** โ **Script Properties**:

| Property | ุงููููุฉ |
|----------|--------|
| `SHEET_ID` | ูุนุฑู Google Sheet |
| `TELEGRAM_BOT_TOKEN` | ุฑูุฒ ุงูุจูุช |
| `TELEGRAM_CHAT_ID` | ูุนุฑู ุงููุญุงุฏุซุฉ |
| `GROQ_KEY` | ููุชุงุญ Groq API |
| `INGRESS_SECRET` | ูููุฉ ุณุฑ ููู Webhook |
| `TG_SECRET_TOKEN` | ูููุฉ ุณุฑ Telegram |

### ุงูุฎุทูุฉ 3: ุงููุดุฑ
1. **Deploy** โ **New deployment**
2. **Type**: Web app
3. **Execute as**: Me
4. **Who has access**: Anyone
5. **Deploy** โ ุงูุณุฎ URL

### ุงูุฎุทูุฉ 4: ุชุดุบูู ุฏูุงู ุงูุฅุนุฏุงุฏ
```javascript
// ูู Apps Script Editorุ ุดุบูู ุจุงูุชุฑุชูุจ:
1. SETUP_MY_ACCOUNTS()     // ุฅูุดุงุก ุงูุญุณุงุจุงุช
2. SETUP_BOT_COMMANDS()    // ุชุณุฌูู ุฃูุงูุฑ ุงูุจูุช
3. setWebhook_DIRECT_no302() // ุฑุจุท Webhook
4. SOV1_setupQueueTrigger_() // ุฅุนุฏุงุฏ ุงููุญูุฒ
```

### ุงูุฎุทูุฉ 5: ุฅุนุฏุงุฏ iPhone Shortcut
```
Automation: When SMS received
Actions:
  1. Get Text from SMS
  2. URL: [Your Web App URL]?secret=YOUR_SECRET
  3. POST JSON:
     {
       "body": [SMS Text],
       "from": [Sender],
       "source": "iphone",
       "secret": "YOUR_INGRESS_SECRET"
     }
```

---

## ๐ ุฌุฏุงูู Google Sheets

### Sheet1 - ุงููุนุงููุงุช
| ุงูุนููุฏ | ุงููุตู |
|--------|-------|
| A | ุงูุชุงุฑูุฎ |
| B | ุงููุตุฏุฑ |
| C | ุงูููู |
| D | ุงูุฃุณุจูุน |
| E | ุงููุตุฏุฑ |
| F | ุฑูู ุงูุญุณุงุจ |
| G | ุฑูู ุงูุจุทุงูุฉ |
| H | ุงููุจูุบ |
| I | ุงูุชุงุฌุฑ |
| J | ุงูุชุตููู |
| K | ุงูููุน |
| L | ุงููุต ุงูุฎุงู |

### Accounts - ุงูุญุณุงุจุงุช
| ุงูุนููุฏ | ุงููุตู |
|--------|-------|
| A | ุงูุงุณู |
| B | ุงูููุน (ุจูู/ุจุทุงูุฉ/ูุญูุธุฉ) |
| C | ุงูุฑูู/ุขุฎุฑ4 |
| D | ุงูุจูู |
| E | **ุงูุฑุตูุฏ** (ูุชุญุฏุซ ุชููุงุฆูุงู) |
| F | ุขุฎุฑ ุชุญุฏูุซ |
| G | ุญุณุงุจู (TRUE/FALSE) |
| H | SMS Pattern |
| I | ุฃุณูุงุก ุจุฏููุฉ |

### Budgets - ุงูููุฒุงููุงุช
| ุงูุนููุฏ | ุงููุตู |
|--------|-------|
| A | ุงูุชุตููู |
| B | ุงูุญุฏ ุงูุดูุฑู |
| C | ุงููุตุฑูู |
| D | ุงููุชุจูู (ุตูุบุฉ) |

### Debt_Index - ุงูุฏููู
| ุงูุนููุฏ | ุงููุตู |
|--------|-------|
| A | ุงูุดุฎุต |
| B | ุฑูู ุญุณุงุจู |
| C | ุงููุจูุบ ุงููุณุชุญู (+ูุฏูู ูู / -ุชุฏูู ูู) |
| D | ุขุฎุฑ ุชุญุฏูุซ |

---

## ๐ง ุงูุชุฎุตูุต

### ุฅุถุงูุฉ ุญุณุงุจุงุชู
ุนุฏูู `SETUP_MY_ACCOUNTS()` ูู Accounts.js:

```javascript
var myAccounts = [
  ['ุณุงุจ - ุฑุฆูุณู', 'ุจูู', '8001', 'ุณุงุจ', 0, new Date(), 'TRUE', 'saib|ุณุงุจ', 'SAIB', ''],
  ['ุณุงุจ - ูุฏู', 'ุจุทุงูุฉ', '3474', 'ุณุงุจ', 0, new Date(), 'TRUE', 'ูุฏู|X3474', '*3474', ''],
  ['ุงูุฑุงุฌุญู', 'ุจูู', '9767', 'ุงูุฑุงุฌุญู', 0, new Date(), 'TRUE', 'alrajhi|ุงูุฑุงุฌุญู', 'AlrajhiBank', ''],
  ['tiqmo', 'ูุญูุธุฉ', 'tiqmo', 'tiqmo', 0, new Date(), 'TRUE', 'tiqmo', 'ุชูููู', ''],
  ['Tamara', 'ุงุฆุชูุงู', 'tamara', 'Tamara', 0, new Date(), 'TRUE', 'tamara|ุชูุงุฑุง', 'Tamara', ''],
];
```

### ุฅุถุงูุฉ ุชุตูููุงุช
ุนุฏูู ูุฑูุฉ **Categories** ูู Google Sheets ุฃู ุงุณุชุฎุฏู ุงููุงุฌูุฉ.

### ุฅุถุงูุฉ ุจููู ุฌุฏูุฏุฉ
ุนุฏูู `detectBank_()` ูู Parser.js:

```javascript
if (/yourbank|ุจููู/i.test(t)) return 'ุงุณู ุงูุจูู';
```

---

## ๐ ูููู ุงููููุงุช

```
๐ money-tracker/
โโโ ๐ Config.js           # ุงูุฅุนุฏุงุฏุงุช ูุงูุจูุฆุฉ
โโโ ๐ Core_Utils.js       # ูุธุงุฆู ุฃุณุงุณูุฉ
โโโ ๐ Utils.js            # ุฃุฏูุงุช ูุณุงุนุฏุฉ
โ
โโโ ๐ Ingress.js          # ๐ช ููุทุฉ ุฏุฎูู Webhook
โโโ ๐ Queue.js            # ๐ฆ ุทุงุจูุฑ ุงููุนุงูุฌุฉ
โโโ ๐ Flow.js             # ๐ ุชุฏูู ุงููุนุงูุฌุฉ
โ
โโโ ๐ AI.js               # ๐ค ุชุตููู ุฐูู (Groq/Gemini)
โโโ ๐ Parser.js           # ๐ ุชุญููู ุงูุฑุณุงุฆู
โโโ ๐ Classifier.js       # ๐ท๏ธ ููุงุนุฏ ุงูุชุตููู
โ
โโโ ๐ Accounts.js         # ๐ฆ ุฅุฏุงุฑุฉ ุงูุญุณุงุจุงุช
โโโ ๐ Balances.js         # ๐ฐ ุชุชุจุน ุงูุฃุฑุตุฏุฉ
โโโ ๐ Debt.js             # ๐ค ุชุชุจุน ุงูุฏููู
โ
โโโ ๐ Telegram.js         # ๐ฒ ุฅุดุนุงุฑุงุช Telegram
โโโ ๐ Telegram_Commands.js# โจ๏ธ ุฃูุงูุฑ ุงูุจูุช
โโโ ๐ Telegram_Actions.js # ๐ Inline Actions
โ
โโโ ๐ WebUI.js            # ๐ ูุงุฌูุฉ ุงูููุจ API
โโโ ๐ Settings.js         # โ๏ธ ุฅุฏุงุฑุฉ ุงูุฅุนุฏุงุฏุงุช
โโโ ๐ DataLinkage.js      # ๐ ุฑุจุท ุงูุจูุงูุงุช
โ
โโโ ๐ index.html          # ๐ ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ
โโโ ๐ settings.html       # โ๏ธ ุตูุญุฉ ุงูุฅุนุฏุงุฏุงุช
โโโ ๐ reports.html        # ๐ ุตูุญุฉ ุงูุชูุงุฑูุฑ
โ
โโโ ๐ README.md           # ๐ ูุฐุง ุงูููู
```

---

## ๐งช ุงูุงุฎุชุจุงุฑ

```javascript
// ุงุฎุชุจุงุฑ ุดุงูู ูููุธุงู
RUN_MASTER_TESTS()

// ุงุฎุชุจุงุฑ ุชุญููู ุฑุณุงูุฉ
TEST_TELEGRAM_MESSAGE_()

// ุงุฎุชุจุงุฑ ุงููุดู ุนู ุงูุจูู
TEST_BANK_DETECTION()
```

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

| ุงููุดููุฉ | ุงูุญู |
|---------|------|
| ูุง ูุตู ุฅุดุนุงุฑ Telegram | ุชุญูู ูู `TELEGRAM_BOT_TOKEN` ู `TELEGRAM_CHAT_ID` |
| ุงูุฑุณุงูุฉ ูุง ุชูุนุงูุฌ | ุชุญูู ูู `INGRESS_SECRET` ูู Shortcut |
| ุงูุชุตููู ุฎุงุทุฆ | ุชุญูู ูู `GROQ_KEY` ุฃู ุฃุถู ูุงุนุฏุฉ ูู Classifier |
| ุงูุฑุตูุฏ ูุง ูุชุญุฏุซ | ุชุฃูุฏ ูู ูุฌูุฏ ุงูุญุณุงุจ ูู Accounts sheet |

---

## ๐ ุฎุงุฑุทุฉ ุงูุทุฑูู

- [x] ุชุญููู SMS ุชููุงุฆู
- [x] ุชุตููู AI (Groq)
- [x] ุฅุดุนุงุฑุงุช Telegram
- [x] ูุงุฌูุฉ ููุจ
- [x] ุชุชุจุน ุงูุฃุฑุตุฏุฉ
- [x] ุชุชุจุน ุงูุฏููู
- [x] ุฃูุงู ูุญุณูู
- [ ] ุชุทุจูู iOS ูุฎุตุต
- [ ] ุฏุนู Android
- [ ] ุชูุงุฑูุฑ PDF
- [ ] ุชุตุฏูุฑ Excel

---

## ๐จโ๐ป ุงููุทูุฑ

**ุดุงูู ุฌุญุฒ ุงููุทูุฑู**
- ูุธุงู ูุตูู ููุงุณุชุฎุฏุงู ุงูุดุฎุตู
- ูุงุจู ููุชุฎุตูุต ูุงูุชูุณูุน

---

## ๐ ุงูุชุฑุฎูุต

ูุฐุง ุงููุดุฑูุน ููุงุณุชุฎุฏุงู ุงูุดุฎุตู. 

---

## ๐ ุขุฎุฑ ุชุญุฏูุซ

**ููุงูุฑ 2026 - V2.1**
- โ ุฅุฒุงูุฉ ุฃุฒุฑุงุฑ Telegram (ุงุณุชุฎุฏู /commands)
- โ ุชุญุณูู ุชูุณูู ุงูุฅุดุนุงุฑุงุช
- โ ุชุญุฏูุซ ุฃุฑุตุฏุฉ ุชููุงุฆู
- โ ูุธุงู ุชุชุจุน ุงูุฏููู
- โ 13 ุฃูุฑ Telegram
- โ ุฃูุงู ูุญุณูู (Auth + Sanitization + Lock)
