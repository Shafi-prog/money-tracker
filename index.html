<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"/>
  <meta http-equiv="Pragma" content="no-cache"/>
  <meta http-equiv="Expires" content="0"/>
  <title>SJA Money Tracker v2.0</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Tajawal', sans-serif; background-color: #f3f4f6; }
    .glass-card { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); }
    [x-cloak] { display: none !important; }
  </style>
  <script>
    function appData() {
      return {
        page: 'dashboard',
        mobileMenu: false,
        loading: false,
        loadingStates: { settings: false, transactions: false, budgets: false, accounts: false },
        setupMode: false,
        setupStep: 1,
        configStatus: { hasSheet: false, hasTelegram: false, hasAI: false },
        setupData: { botToken: '', chatId: '', sheetId: '' },
        stats: { income: 0, expense: 0, balance: 0, savings: 0 },
        transactions: [],
        allTransactions: [],
        filteredTransactions: [],
        searchQuery: '',
        budgets: [],
        errorMessage: '',
        showAddModal: false,
        showEditTransactionModal: false,
        editingTransaction: null,
        newTransaction: { amount: '', merchant: '', category: 'Ø£Ø®Ø±Ù‰', type: 'expense' },
        categories: [], // Loaded dynamically from backend
        categoriesLoaded: false,
        userSettings: { user_name: '', user_email: '', enable_notifications: true, telegram_notifications: true, budget_alerts: true, default_currency: 'SAR', language: 'ar', salary_day: 1, auto_apply_rules: true },
        reportPeriod: 'monthly',
        reportData: null,
        accounts: [],
        showAccountModal: false,
        showAIExtraction: false,
        editingAccount: null,
        newAccount: { name: '', type: 'Ø¨Ù†Ùƒ', number: '', bank: '', aliases: '', isMine: true, isInternal: false, smsText: '' },
        showBudgetModal: false,
        editingBudget: null,
        newBudget: { category: '', limit: '' },
        showPrivacyModal: false,
        toasts: [],
        // Test panel states
        testingStates: { sms: false, ai: false, telegram: false, fullFlow: false },
        testResults: { sms: '', ai: '', telegram: '', fullFlow: '' },
        
        navigateToPage(pageName) {
          this.page = pageName;
          // Auto-load data when navigating to certain pages
          if (pageName === 'reports' && !this.reportData) {
            this.loadReport('monthly');
          }
        },
        
        init() {
          console.log('ğŸš€ SJA Money Tracker v2.1 - Fast Loading');
          console.log('âœ… Using optimized fast API with caching');
          this.loading = true;
          this.loadTime = Date.now();
          
          // âœ… Safety timeout - stop loading after 10 seconds no matter what
          var self = this;
          setTimeout(function() {
            if (self.loading) {
              console.warn('âš ï¸ Loading timeout - forcing complete');
              self.loading = false;
              if (!self.transactions || self.transactions.length === 0) {
                self.errorMessage = 'ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„.';
              }
            }
          }, 10000);
          
          // Try fast API first, fallback to regular
          this.tryFastLoad();
        },
        
        // NEW: Fast loading with fallback
        tryFastLoad() {
          if (typeof google === 'undefined' || !google.script) {
            console.error('Google Apps Script API not available');
            this.loading = false;
            this.errorMessage = 'Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…';
            return;
          }
          
          console.log('âš¡ Trying fast API...');
          google.script.run
            .withSuccessHandler(result => {
              if (result && result.success && result.data) {
                console.log('âš¡ Fast load succeeded in ' + (Date.now() - this.loadTime) + 'ms');
                this.processFastData(result.data);
              } else {
                console.log('âš ï¸ Fast API returned no data, falling back...');
                this.loadSettings();
              }
            })
            .withFailureHandler(err => {
              console.log('âš ï¸ Fast API failed, falling back to regular: ' + err);
              this.loadSettings();
            })
            .SOV1_FAST_getDashboard();
        },
        
        // Load categories from backend
        loadCategories() {
          if (this.categoriesLoaded) return;
          
          if (typeof google === 'undefined' || !google.script) {
            // Fallback to defaults
            this.categories = ['Ø·Ø¹Ø§Ù…', 'Ù†Ù‚Ù„', 'ÙÙˆØ§ØªÙŠØ±', 'ØªØ³ÙˆÙ‚', 'Ø³ÙƒÙ†', 'ØªØ±ÙÙŠÙ‡', 'ØµØ­Ø©', 'Ø±Ø§ØªØ¨', 'ØªØ­ÙˆÙŠÙ„', 'Ø£Ø®Ø±Ù‰'];
            return;
          }
          
          google.script.run
            .withSuccessHandler(cats => {
              if (cats && Array.isArray(cats) && cats.length > 0) {
                // Categories can be objects with name/icon or plain strings
                this.categories = cats.map(c => typeof c === 'object' ? c.name : c);
                this.categoriesLoaded = true;
                console.log('âœ… Categories loaded:', this.categories.length);
              } else {
                // Fallback defaults
                this.categories = ['Ø·Ø¹Ø§Ù…', 'Ù†Ù‚Ù„', 'ÙÙˆØ§ØªÙŠØ±', 'ØªØ³ÙˆÙ‚', 'Ø³ÙƒÙ†', 'ØªØ±ÙÙŠÙ‡', 'ØµØ­Ø©', 'Ø±Ø§ØªØ¨', 'ØªØ­ÙˆÙŠÙ„', 'Ø£Ø®Ø±Ù‰'];
              }
            })
            .withFailureHandler(err => {
              console.warn('âš ï¸ Failed to load categories:', err);
              this.categories = ['Ø·Ø¹Ø§Ù…', 'Ù†Ù‚Ù„', 'ÙÙˆØ§ØªÙŠØ±', 'ØªØ³ÙˆÙ‚', 'Ø³ÙƒÙ†', 'ØªØ±ÙÙŠÙ‡', 'ØµØ­Ø©', 'Ø±Ø§ØªØ¨', 'ØªØ­ÙˆÙŠÙ„', 'Ø£Ø®Ø±Ù‰'];
            })
            .SOV1_UI_getCategories_('OPEN');
        },
        
        // NEW: Process fast API data
        processFastData(data) {
          try {
            if (data.kpi) {
              this.incomeMonth = data.kpi.incomeM || 0;
              this.spendMonth = data.kpi.spendM || 0;
              this.netMonth = data.kpi.netM || 0;
            }
            if (data.recentTransactions) {
              this.transactions = data.recentTransactions;
            }
            if (data.budgets) {
              this.budgets = data.budgets;
            }
            // Also load categories
            this.loadCategories();
            this.loading = false;
            console.log('âœ… Data loaded in ' + (Date.now() - this.loadTime) + 'ms');
          } catch (e) {
            console.error('Error processing fast data:', e);
            this.loadSettings();
          }
        },
        
        loadSettings() {
          // Load categories in parallel
          this.loadCategories();
          
          google.script.run
            .withSuccessHandler(result => {
              if (result && result.settings) {
                this.userSettings = result.settings;
                console.log('Settings loaded:', result.settings);
              }
              // After settings load, refresh data
              this.refreshData();
            })
            .withFailureHandler(err => {
              console.error('Error loading settings:', err);
              // Load data anyway even if settings fail
              this.refreshData();
            })
            .SOV1_UI_getSettings();
        },
        
        checkFirstTimeSetup() {
          this.loading = true;
          
          // Check if google.script.run is available
          if (typeof google === 'undefined' || !google.script) {
            console.error('Google Apps Script API not available');
            this.loading = false;
            this.errorMessage = 'Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…. ØªØ£ÙƒØ¯ Ù…Ù† Ù†Ø´Ø± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­.';
            return;
          }
          
          google.script.run
            .withSuccessHandler(status => {
              this.configStatus = status;
              if (!status.hasSheet) {
                this.setupMode = true;
                this.loading = false;
                this.errorMessage = 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¹Ø¯Ø§Ø¯ Google Sheets Ø£ÙˆÙ„Ø§Ù‹';
              } else {
                this.refreshData();
              }
            })
            .withFailureHandler(err => {
              console.error('Config check failed:', err);
              this.loading = false;
              this.errorMessage = 'ØªØ­Ø°ÙŠØ±: Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ø§Ù„Ù†Ø¸Ø§Ù… ØºÙŠØ± Ù…Ù‡ÙŠØ£ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„';
              // Try to load data anyway
              this.refreshData();
            })
            .SOV1_UI_checkConfig();
        },

        refreshData() {
          this.loading = true;
          this.errorMessage = '';
          
          var timeoutId = null;
          var completed = false;
          
          // Extended timeout with better error message
          timeoutId = setTimeout(() => {
            if (!completed && this.loading) {
              this.loading = false;
              this.errorMessage = 'â±ï¸ Ø§Ù†ØªÙ‡Øª Ù…Ù‡Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ (30 Ø«Ø§Ù†ÙŠØ©). Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ø§Ù„Ø³Ø¨Ø¨:\n' +
                '1. Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª Ø¨Ø·ÙŠØ¡\n' +
                '2. ÙƒÙ…ÙŠØ© Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ¨ÙŠØ±Ø© ÙÙŠ Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„\n' +
                '3. Ø®Ø·Ø£ ÙÙŠ Google Apps Script\n\n' +
                'Ø¬Ø±Ø¨: ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø© Ø£Ùˆ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Google Sheets';
              console.error('Timeout after 30 seconds');
            }
          }, 30000); // Increased to 30 seconds
          
          // Check if google.script.run is available
          if (typeof google === 'undefined' || !google.script) {
            completed = true;
            clearTimeout(timeoutId);
            this.loading = false;
            this.errorMessage = 'âŒ Ø®Ø·Ø£: Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ Google Apps Script\n' +
              'ØªØ£ÙƒØ¯ Ù…Ù†:\n' +
              '1. Ø£Ù†Ùƒ ØªØ³ØªØ®Ø¯Ù… Ø±Ø§Ø¨Ø· Web App Ø§Ù„Ù…Ù†Ø´ÙˆØ±\n' +
              '2. Ù„Ø¯ÙŠÙƒ Ø¥Ø°Ù† Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…Ù„Ù\n' +
              '3. Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù…Ù†Ø´ÙˆØ± Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­';
            return;
          }
          
          console.log('ğŸ”„ Loading dashboard data...');
          
          // âœ… OPTIMIZED: Single API call instead of 4 separate calls
          google.script.run
            .withSuccessHandler(data => {
              completed = true;
              clearTimeout(timeoutId);
              
              console.log('âœ… All dashboard data received:', data);
              
              // CRITICAL: Show debug log if available
              if (data && data.debugLog && Array.isArray(data.debugLog)) {
                console.log('ğŸ“‹ Debug Log from Backend:');
                data.debugLog.forEach(log => console.log('  ' + log));
              }
              
              // Check if response is null or undefined
              if (!data || data === null || typeof data === 'undefined') {
                this.loading = false;
                this.errorMessage = 'âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù….\n' +
                  'Ø§Ù„Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„Ù…Ø­ØªÙ…Ù„Ø©:\n' +
                  '1. Google Sheets ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ Ø£Ùˆ Ù…Ø­Ø°ÙˆÙ\n' +
                  '2. Ù„Ø§ ØªÙ…Ù„Ùƒ ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„ÙˆØµÙˆÙ„\n' +
                  '3. Ø®Ø·Ø£ ÙÙŠ Backend Script\n\n' +
                  'Ø¬Ø±Ø¨: ÙØªØ­ Google Sheets Ù…Ø¨Ø§Ø´Ø±Ø© ÙˆØ§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª';
                console.error('âŒ Response is null/undefined');
                return;
              }
              
              // Check for error in response
              if (data.error || data.success === false) {
                this.loading = false;
                
                // Build detailed error message
                var errorDetails = 'âŒ Ø®Ø·Ø£ Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…: ' + (data.error || 'Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ');
                
                // Add debug log to error message if available
                if (data.debugLog && Array.isArray(data.debugLog)) {
                  errorDetails += '\n\nğŸ“‹ ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªØ´Ø®ÙŠØµ:\n' + data.debugLog.join('\n');
                }
                
                // Add error stack if available
                if (data.errorStack) {
                  errorDetails += '\n\nğŸ” Stack Trace:\n' + data.errorStack;
                }
                
                errorDetails += '\n\nÙ‚Ø¯ ÙŠÙƒÙˆÙ† Ø§Ù„Ø³Ø¨Ø¨:\n' +
                  '1. Ø£Ø®Ø·Ø§Ø¡ ÙÙŠ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ©\n' +
                  '2. Ù…Ø´ÙƒÙ„Ø© ÙÙŠ ØµÙ„Ø§Ø­ÙŠØ§Øª Google Sheets\n' +
                  '3. Ø¨ÙŠØ§Ù†Ø§Øª ØªØ§Ù„ÙØ© ÙÙŠ Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„';
                
                this.errorMessage = errorDetails;
                console.error('âŒ Backend error:', data);
                return;
              }
              
              // Load KPI stats
              if (data.dashboard && data.dashboard.kpi) {
                this.stats.income = data.dashboard.kpi.incomeM || 0;
                this.stats.expense = data.dashboard.kpi.spendM || 0;
                this.stats.balance = data.dashboard.kpi.netM || 0;
                this.stats.savings = data.dashboard.kpi.totalRemain || 0;
                console.log('âœ… KPI loaded:', this.stats);
              } else {
                console.warn('âš ï¸ No KPI data in response');
              }
              
              // Load transactions
              if (data.transactions && Array.isArray(data.transactions)) {
                this.allTransactions = data.transactions.map((tx, i) => ({
                  id: tx.row || i,
                  date: tx.date,
                  merchant: tx.merchant || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                  category: tx.category || tx.type || 'Ø£Ø®Ø±Ù‰',
                  amount: tx.amount || 0,
                  type: tx.type || ''
                }));
                this.transactions = this.allTransactions.slice(0, 10);
                console.log('âœ… Transactions loaded:', this.transactions.length);
              } else {
                console.warn('âš ï¸ No transactions in response');
                this.transactions = [];
                this.allTransactions = [];
              }
              
              // Load budgets
              if (data.budgets && Array.isArray(data.budgets)) {
                this.budgets = data.budgets;
                console.log('âœ… Budgets loaded:', this.budgets.length);
              } else {
                console.warn('âš ï¸ No budgets in response');
                this.budgets = [];
              }
              
              // Load accounts
              if (data.accounts && Array.isArray(data.accounts)) {
                this.accounts = data.accounts;
                console.log('âœ… Accounts loaded:', this.accounts.length);
              } else {
                this.accounts = [];
              }
              
              this.loading = false;
              console.log('âœ… Dashboard refresh complete');
            })
            .withFailureHandler(err => {
              completed = true;
              clearTimeout(timeoutId);
              
              console.error('âŒ Error loading data:', err);
              this.loading = false;
              
              var errorMsg = 'âŒ ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:\n';
              
              if (err && err.message) {
                errorMsg += err.message;
                
                // Add helpful hints based on error type
                if (err.message.includes('ØºÙŠØ± Ù…ØµØ±Ø­') || err.message.includes('unauthorized')) {
                  errorMsg += '\n\nğŸ’¡ Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ù…Ø­ØªÙ…Ù„: Ù…Ø´ÙƒÙ„Ø© ÙÙŠ ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„ÙˆØµÙˆÙ„';
                } else if (err.message.includes('not found') || err.message.includes('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ±')) {
                  errorMsg += '\n\nğŸ’¡ Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ù…Ø­ØªÙ…Ù„: Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©';
                } else if (err.message.includes('timeout')) {
                  errorMsg += '\n\nğŸ’¡ Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ù…Ø­ØªÙ…Ù„: Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø·ÙŠØ¡ Ø£Ùˆ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ«ÙŠØ±Ø©';
                }
              } else {
                errorMsg += String(err);
              }
              
              errorMsg += '\n\nğŸ”§ Ø§Ù„Ø­Ù„ÙˆÙ„ Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©:\n' +
                '1. ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø© (F5)\n' +
                '2. ÙØªØ­ Google Sheets ÙˆØ§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª\n' +
                '3. ØªØ´ØºÙŠÙ„ testDashboardData() ÙÙŠ Apps Script Editor';
              
              this.errorMessage = errorMsg;
            })
            .SOV1_UI_getAllDashboardData_safe('OPEN');
        },
        
        completeSetup() {
          this.loading = true;
          google.script.run
            .withSuccessHandler(result => {
              this.loading = false;
              if (result.success) {
                this.setupMode = false;
                this.refreshData();
                alert('âœ… ØªÙ… Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ù†Ø¬Ø§Ø­!');
              } else {
                alert('âŒ ÙØ´Ù„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯: ' + result.message);
              }
            })
            .withFailureHandler(err => {
              this.loading = false;
              alert('âŒ Ø®Ø·Ø£: ' + err.message);
            })
            .SOV1_UI_quickSetup(this.setupData);
        },
        
        skipSetup() {
          this.setupMode = false;
          this.refreshData();
        },
        
        getBudgetProgress(budget) {
          if (!budget.limit || budget.limit === 0) return 0;
          return Math.min(100, (budget.spent / budget.limit) * 100);
        },
        
        getBudgetColor(progress) {
          if (progress >= 100) return 'bg-red-500';
          if (progress >= 80) return 'bg-yellow-500';
          return 'bg-green-500';
        },

        formatMoney(amount) {
          return new Intl.NumberFormat('ar-SA', { style: 'currency', currency: 'SAR' }).format(amount || 0);
        },

        formatDate(dateStr) {
          if(!dateStr) return '';
          const d = new Date(dateStr);
          if (isNaN(d.getTime())) return dateStr; // Return as-is if invalid
          return d.toLocaleDateString('ar-SA', { month: 'short', day: 'numeric', hour: '2-digit', minute:'2-digit' });
        },
        
        getCategoryIcon(cat) {
            const map = { 
              'Ø·Ø¹Ø§Ù…': 'ğŸ”', 'Ù†Ù‚Ù„': 'ğŸš•', 'ÙÙˆØ§ØªÙŠØ±': 'ğŸ§¾', 'ØªØ³ÙˆÙ‚': 'ğŸ›ï¸', 
              'Ù…Ø·Ø§Ø¹Ù…': 'ğŸŒ­', 'Ø³ÙƒÙ†': 'ğŸ ', 'ØªØ±ÙÙŠÙ‡': 'ğŸ®', 'ØµØ­Ø©': 'ğŸ’Š',
              'ØªØ¹Ù„ÙŠÙ…': 'ğŸ“š', 'Ø±Ø§ØªØ¨': 'ğŸ’°', 'Ø§Ø³ØªØ«Ù…Ø§Ø±': 'ğŸ“ˆ'
            };
            return map[cat] || 'ğŸ’¸';
        },

        showAllTransactions() {
          this.page = 'transactions';
          this.transactions = this.allTransactions;
        },
        
        openAddModal() {
          this.showAddModal = true;
          this.newTransaction = { amount: '', merchant: '', category: 'Ø£Ø®Ø±Ù‰', type: 'expense' };
        },
        
        deleteTransaction(tx) {
          if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©ØŸ\n' + tx.merchant + ' - ' + this.formatMoney(tx.amount))) {
            return;
          }
          
          this.loading = true;
          google.script.run
            .withSuccessHandler(result => {
              this.loading = false;
              alert('âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­');
              this.refreshData();
            })
            .withFailureHandler(err => {
              this.loading = false;
              this.errorMessage = 'ÙØ´Ù„ Ø­Ø°Ù Ø§Ù„Ø¹Ù…Ù„ÙŠØ©: ' + (err.message || err);
              alert('âŒ ÙØ´Ù„ Ø­Ø°Ù Ø§Ù„Ø¹Ù…Ù„ÙŠØ©: ' + (err.message || err));
            })
            .SOV1_UI_deleteTransaction(tx.id);
        },
        
        addTransaction() {
          // Validation
          if (!this.newTransaction.merchant || this.newTransaction.merchant.trim() === '') {
            this.showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„ØªØ§Ø¬Ø±', 'error');
            return;
          }
          
          if (!this.isPositiveNumber(this.newTransaction.amount)) {
            this.showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­ Ø£ÙƒØ¨Ø± Ù…Ù† ØµÙØ±', 'error');
            return;
          }
          
          // Optimistic UI: Add to UI immediately
          const optimisticTx = {
            id: 'temp-' + Date.now(),
            date: new Date().toISOString(),
            merchant: this.newTransaction.merchant,
            category: this.newTransaction.category,
            amount: this.newTransaction.type === 'expense' ? this.newTransaction.amount : -this.newTransaction.amount,
            type: this.newTransaction.type
          };
          
          this.transactions.unshift(optimisticTx);
          this.allTransactions.unshift(optimisticTx);
          
          // Update stats optimistically
          if (this.newTransaction.type === 'expense') {
            this.stats.expense += parseFloat(this.newTransaction.amount);
          } else {
            this.stats.income += parseFloat(this.newTransaction.amount);
          }
          this.stats.balance = this.stats.income - this.stats.expense;
          
          // Close modal immediately for better UX
          this.showAddModal = false;
          
          const text = `Ø£Ø¶Ù: ${this.newTransaction.type === 'income' ? '-' : ''}${this.newTransaction.amount} | ${this.newTransaction.merchant} | ${this.newTransaction.category}`;
          
          console.log('Adding transaction (optimistic):', text);
          
          // Backend sync (async)
          google.script.run
            .withSuccessHandler(result => {
              console.log('Transaction confirmed by backend:', result);
              // Refresh to get accurate data from server
              setTimeout(() => this.refreshData(), 1000);
            })
            .withFailureHandler(err => {
              // Rollback optimistic update on failure
              this.transactions = this.transactions.filter(t => t.id !== optimisticTx.id);
              this.allTransactions = this.allTransactions.filter(t => t.id !== optimisticTx.id);
              this.errorMessage = 'ÙØ´Ù„ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù…Ù„ÙŠØ©: ' + (err.message || err);
              alert('âŒ ÙØ´Ù„ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù…Ù„ÙŠØ©. Ø³ÙŠØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ«.');
              this.refreshData();
            })
            .SOV1_UI_addManualTransaction(text);
        },
        
        saveSettings() {
          // Validation
          if (!this.userSettings.user_name || this.userSettings.user_name.trim() === '') {
            this.showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù…', 'error');
            return;
          }
          
          if (this.userSettings.user_email && !this.isValidEmail(this.userSettings.user_email)) {
            this.showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØµØ­ÙŠØ­', 'error');
            return;
          }
          
          this.loadingStates.settings = true;
          
          google.script.run
            .withSuccessHandler((result) => {
              this.loadingStates.settings = false;
              this.showToast('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
              // Refresh settings to update UI immediately
              this.loadSettings();
            })
            .withFailureHandler(err => {
              this.loadingStates.settings = false;
              this.showToast('ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª', 'error');
            })
            .SOV1_UI_saveSettings(this.userSettings);
        },
        
        loadReport(period) {
          this.reportPeriod = period;
          this.loading = true;
          
          google.script.run
            .withSuccessHandler(data => {
              this.loading = false;
              this.reportData = data;
              console.log('Report data loaded:', data);
            })
            .withFailureHandler(err => {
              this.loading = false;
              this.errorMessage = 'ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ±: ' + (err.message || err);
              console.error('Error loading report:', err);
            })
            .SOV1_UI_getReportData('OPEN', period);
        },
        
        loadAccounts() {
          google.script.run
            .withSuccessHandler(data => {
              this.accounts = data || [];
              console.log('Accounts loaded:', data);
            })
            .withFailureHandler(err => {
              console.error('Error loading accounts:', err);
              this.accounts = [];
            })
            .SOV1_UI_getAccounts();
        },
        
        addOrEditBudget() {
          // Validation
          if (!this.newBudget.category || this.newBudget.category.trim() === '') {
            this.showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„ØªØµÙ†ÙŠÙ', 'error');
            return;
          }
          
          if (!this.isPositiveNumber(this.newBudget.limit)) {
            this.showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­ Ø£ÙƒØ¨Ø± Ù…Ù† ØµÙØ±', 'error');
            return;
          }
          
          this.loadingStates.budgets = true;
          
          if (this.editingBudget) {
            // Update
            google.script.run
              .withSuccessHandler(result => {
                this.loadingStates.budgets = false;
                this.showBudgetModal = false;
                this.showToast('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­');
                this.refreshData();
              })
              .withFailureHandler(err => {
                this.loadingStates.budgets = false;
                this.showToast('ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©', 'error');
              })
              .SOV1_UI_updateBudget(this.newBudget.category, parseFloat(this.newBudget.limit));
          } else {
            // Create
            google.script.run
              .withSuccessHandler(result => {
                this.loadingStates.budgets = false;
                this.showBudgetModal = false;
                this.showToast('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­');
                this.refreshData();
              })
              .withFailureHandler(err => {
                this.loadingStates.budgets = false;
                this.showToast('ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©', 'error');
              })
              .SOV1_UI_saveBudget(this.newBudget);
          }
        },
        
        deleteBudget(category) {
          if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù…ÙŠØ²Ø§Ù†ÙŠØ© ' + category + 'ØŸ')) {
            return;
          }
          
          this.loadingStates.budgets = true;
          google.script.run
            .withSuccessHandler(result => {
              this.loadingStates.budgets = false;
              this.showToast('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©');
              this.refreshData();
            })
            .withFailureHandler(err => {
              this.loadingStates.budgets = false;
              this.showToast('ÙØ´Ù„ Ø­Ø°Ù Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©', 'error');
            })
            .SOV1_UI_deleteBudget(category);
        },
        
        saveSettings() {
          if (!this.userSettings.user_name) {
            alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù…');
            return;
          }
          
          this.loading = true;
          console.log('Saving settings:', this.userSettings);
          
          // Safety timeout
          const timeoutId = setTimeout(() => {
            this.loading = false;
            this.errorMessage = 'Ø§Ù†ØªÙ‡Øª Ù…Ù‡Ù„Ø© Ø§Ù„Ø­ÙØ¸';
          }, 8000);
          
          google.script.run
            .withSuccessHandler((result) => {
              clearTimeout(timeoutId);
              this.loading = false;
              alert('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
              console.log('Settings saved:', result);
            })
            .withFailureHandler(err => {
              clearTimeout(timeoutId);
              this.loading = false;
              this.errorMessage = 'ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª: ' + (err.message || err);
              alert('âŒ ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª: ' + (err.message || err));
            })
            .SOV1_UI_saveSettings(this.userSettings);
        },
        
        openAccountModal() {
          this.editingAccount = null;
          this.newAccount = { name: '', type: 'Ø¨Ù†Ùƒ', number: '', bank: '', aliases: '', isMine: true, isInternal: false, smsText: '' };
          this.showAccountModal = true;
        },
        
        extractFromSMS() {
          if (!this.newAccount.smsText || this.newAccount.smsText.trim().length === 0) {
            alert('âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ù„ØµÙ‚ Ù†Øµ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø£ÙˆÙ„Ø§Ù‹');
            return;
          }
          
          this.loading = true;
          
          google.script.run
            .withSuccessHandler(result => {
              this.loading = false;
              if (result.success && result.account) {
                // Auto-fill form with AI extracted data
                this.newAccount = { ...this.newAccount, ...result.account };
                alert('âœ… ØªÙ… Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø±Ø³Ø§Ù„Ø©!');
              } else {
                alert('âŒ ÙØ´Ù„ Ø§Ù„Ø§Ø³ØªØ®Ø±Ø§Ø¬: ' + (result.error || 'Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'));
              }
            })
            .withFailureHandler(err => {
              this.loading = false;
              alert('âŒ Ø®Ø·Ø£: ' + (err.message || err));
            })
            .SOV1_UI_extractAccountFromSMS(this.newAccount.smsText);
        },
        
        editAccount(account) {
          this.editingAccount = account;
          this.newAccount = { ...account };
          this.showAccountModal = true;
        },
        
        saveAccount() {
          if (!this.newAccount.name || !this.newAccount.type) {
            alert('Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ù†ÙˆØ¹ Ù…Ø·Ù„ÙˆØ¨Ø§Ù†');
            return;
          }
          
          this.loading = true;
          
          if (this.editingAccount) {
            // Update
            google.script.run
              .withSuccessHandler(result => {
                this.loading = false;
                this.showAccountModal = false;
                alert('âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø³Ø§Ø¨');
                this.loadAccounts();
              })
              .withFailureHandler(err => {
                this.loading = false;
                alert('âŒ ÙØ´Ù„ Ø§Ù„ØªØ­Ø¯ÙŠØ«: ' + (err.message || err));
              })
              .SOV1_UI_updateAccount(this.editingAccount.id, this.newAccount);
          } else {
            // Add new
            google.script.run
              .withSuccessHandler(result => {
                this.loading = false;
                this.showAccountModal = false;
                alert('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø³Ø§Ø¨');
                this.loadAccounts();
              })
              .withFailureHandler(err => {
                this.loading = false;
                alert('âŒ ÙØ´Ù„ Ø§Ù„Ø¥Ø¶Ø§ÙØ©: ' + (err.message || err));
              })
              .SOV1_UI_addAccount(this.newAccount);
          }
        },
        
        deleteAccount(account) {
          if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ø­Ø³Ø§Ø¨: ' + account.name + '?')) {
            return;
          }
          
          this.loading = true;
          google.script.run
            .withSuccessHandler(result => {
              this.loading = false;
              alert('âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ø­Ø³Ø§Ø¨');
              this.loadAccounts();
            })
            .withFailureHandler(err => {
              this.loading = false;
              alert('âŒ ÙØ´Ù„ Ø§Ù„Ø­Ø°Ù');
            })
            .SOV1_UI_deleteAccount(account.id);
        },
        
        showToast(message, type = 'success') {
          const id = Date.now();
          this.toasts.push({ id, message, type });
          setTimeout(() => {
            this.toasts = this.toasts.filter(t => t.id !== id);
          }, 3000);
        },
        
        isValidEmail(email) {
          const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
          return regex.test(email);
        },
        
        isPositiveNumber(value) {
          const num = parseFloat(value);
          return !isNaN(num) && num > 0;
        },

        // ============ TEST PANEL FUNCTIONS ============
        
        testSMSParsing() {
          this.testingStates.sms = true;
          this.testResults.sms = 'Ø¬Ø§Ø±ÙŠ Ø§Ø®ØªØ¨Ø§Ø± ØªØ­Ù„ÙŠÙ„ SMS...';
          
          // Sample SMS message for testing
          const testSMS = 'ØªÙ… Ø®ØµÙ… Ù…Ø¨Ù„Øº 150.00 Ø±ÙŠØ§Ù„ Ù…Ù† Ø­Ø³Ø§Ø¨Ùƒ Ø§Ù„Ø¬Ø§Ø±ÙŠ ****1234 Ù„Ø¯Ù‰ Ù…Ø§ÙƒØ¯ÙˆÙ†Ø§Ù„Ø¯Ø² ÙÙŠ 2025/01/24';
          
          google.script.run
            .withSuccessHandler(result => {
              this.testingStates.sms = false;
              if (result && result.success) {
                this.testResults.sms = 'âœ… Ù†Ø¬Ø­ ØªØ­Ù„ÙŠÙ„ SMS!\n\n' +
                  'Ø§Ù„Ù…Ø¨Ù„Øº: ' + (result.amount || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯') + '\n' +
                  'Ø§Ù„ØªØ§Ø¬Ø±: ' + (result.merchant || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯') + '\n' +
                  'Ø§Ù„Ø­Ø³Ø§Ø¨: ' + (result.account || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯') + '\n' +
                  'Ø§Ù„Ù†ÙˆØ¹: ' + (result.type || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯');
              } else {
                this.testResults.sms = 'âš ï¸ ÙØ´Ù„ Ø§Ù„ØªØ­Ù„ÙŠÙ„: ' + (result?.error || 'Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ');
              }
            })
            .withFailureHandler(err => {
              this.testingStates.sms = false;
              this.testResults.sms = 'âŒ Ø®Ø·Ø£: ' + (err.message || err);
            })
            .SOV1_UI_testParseSMS(testSMS);
        },
        
        testAIClassification() {
          this.testingStates.ai = true;
          this.testResults.ai = 'Ø¬Ø§Ø±ÙŠ Ø§Ø®ØªØ¨Ø§Ø± ØªØµÙ†ÙŠÙ AI...';
          
          google.script.run
            .withSuccessHandler(result => {
              this.testingStates.ai = false;
              if (result && result.success) {
                this.testResults.ai = 'âœ… Ù†Ø¬Ø­ ØªØµÙ†ÙŠÙ AI!\n\n' +
                  'Ø§Ù„ØªØµÙ†ÙŠÙ: ' + (result.category || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯') + '\n' +
                  'Ø§Ù„Ø«Ù‚Ø©: ' + (result.confidence || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯') + '%\n' +
                  'Ø§Ù„Ù…ØµØ¯Ø±: ' + (result.source || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯');
              } else {
                this.testResults.ai = 'âš ï¸ ÙØ´Ù„ Ø§Ù„ØªØµÙ†ÙŠÙ: ' + (result?.error || 'Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ');
              }
            })
            .withFailureHandler(err => {
              this.testingStates.ai = false;
              this.testResults.ai = 'âŒ Ø®Ø·Ø£: ' + (err.message || err);
            })
            .SOV1_UI_testAIClassify('Ù…Ø§ÙƒØ¯ÙˆÙ†Ø§Ù„Ø¯Ø²', 150);
        },
        
        testTelegram() {
          this.testingStates.telegram = true;
          this.testResults.telegram = 'Ø¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© ØªØ¬Ø±ÙŠØ¨ÙŠØ©...';
          
          google.script.run
            .withSuccessHandler(result => {
              this.testingStates.telegram = false;
              if (result && result.success) {
                this.testResults.telegram = 'âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­!\n\n' +
                  'ØªØ­Ù‚Ù‚ Ù…Ù† ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ©.';
              } else {
                this.testResults.telegram = 'âš ï¸ ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: ' + (result?.error || 'Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ');
              }
            })
            .withFailureHandler(err => {
              this.testingStates.telegram = false;
              this.testResults.telegram = 'âŒ Ø®Ø·Ø£: ' + (err.message || err);
            })
            .SOV1_UI_testTelegram();
        },
        
        testFullFlow() {
          this.testingStates.fullFlow = true;
          this.testResults.fullFlow = 'Ø¬Ø§Ø±ÙŠ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ¯ÙÙ‚ Ø§Ù„ÙƒØ§Ù…Ù„...\n' +
            '1ï¸âƒ£ ØªØ­Ù„ÙŠÙ„ SMS...\n' +
            '2ï¸âƒ£ ØªØµÙ†ÙŠÙ AI...\n' +
            '3ï¸âƒ£ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...\n' +
            '4ï¸âƒ£ Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø±...';
          
          google.script.run
            .withSuccessHandler(result => {
              this.testingStates.fullFlow = false;
              if (result && result.success) {
                this.testResults.fullFlow = 'âœ… Ù†Ø¬Ø­ Ø§Ù„ØªØ¯ÙÙ‚ Ø§Ù„ÙƒØ§Ù…Ù„!\n\n' +
                  'ğŸ“ SMS: ' + (result.steps?.sms || 'âœ“') + '\n' +
                  'ğŸ¤– AI: ' + (result.steps?.ai || 'âœ“') + '\n' +
                  'ğŸ’¾ Save: ' + (result.steps?.save || 'âœ“') + '\n' +
                  'ğŸ“± Telegram: ' + (result.steps?.telegram || 'âœ“') + '\n\n' +
                  'Ø§Ù„Ù†ØªÙŠØ¬Ø©: ' + (result.summary || 'Ø§ÙƒØªÙ…Ù„ Ø¨Ù†Ø¬Ø§Ø­');
              } else {
                this.testResults.fullFlow = 'âš ï¸ ÙØ´Ù„ Ø§Ù„ØªØ¯ÙÙ‚: ' + (result?.error || 'Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ') +
                  '\n\nØ§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©:\n' +
                  (result?.steps ? JSON.stringify(result.steps, null, 2) : 'ØºÙŠØ± Ù…ØªØ§Ø­');
              }
            })
            .withFailureHandler(err => {
              this.testingStates.fullFlow = false;
              this.testResults.fullFlow = 'âŒ Ø®Ø·Ø£: ' + (err.message || err);
            })
            .SOV1_UI_testFullFlow();
        },
        // ============ END TEST PANEL ============

        // ============ REPORT EXPORT FUNCTIONS ============
        exportReportPDF() {
          this.showToast('Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ PDF...', 'info');
          
          // Create a printable version of the report
          const reportContent = document.getElementById('reportContent');
          if (!reportContent) {
            this.showToast('Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªÙ‚Ø±ÙŠØ± Ù„Ù„ØªØµØ¯ÙŠØ±', 'error');
            return;
          }
          
          // Create PDF-friendly HTML
          const periodNames = { daily: 'Ø§Ù„ÙŠÙˆÙ…', weekly: 'Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹', monthly: 'Ø§Ù„Ø´Ù‡Ø±' };
          const periodName = periodNames[this.reportPeriod] || 'Ø§Ù„ØªÙ‚Ø±ÙŠØ±';
          
          const printContent = `
            <!DOCTYPE html>
            <html lang="ar" dir="rtl">
            <head>
              <meta charset="utf-8">
              <title>ØªÙ‚Ø±ÙŠØ± ${periodName} - SJA Money Tracker</title>
              <style>
                body { font-family: 'Segoe UI', Tahoma, Arial, sans-serif; padding: 40px; direction: rtl; }
                h1 { color: #16a34a; margin-bottom: 10px; }
                .date { color: #666; margin-bottom: 30px; }
                .stats { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 30px; }
                .stat-box { border: 1px solid #e5e7eb; border-radius: 12px; padding: 20px; text-align: center; }
                .stat-label { font-size: 14px; color: #666; margin-bottom: 5px; }
                .stat-value { font-size: 24px; font-weight: bold; }
                .green { color: #16a34a; }
                .red { color: #dc2626; }
                .blue { color: #2563eb; }
                .categories { margin-top: 30px; }
                .categories h2 { margin-bottom: 20px; }
                .cat-item { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #f3f4f6; }
                .footer { margin-top: 50px; text-align: center; color: #999; font-size: 12px; }
                @media print { body { padding: 20px; } }
              </style>
            </head>
            <body>
              <h1>ğŸ“Š ØªÙ‚Ø±ÙŠØ± ${periodName}</h1>
              <div class="date">Ø§Ù„ØªØ§Ø±ÙŠØ®: ${new Date().toLocaleDateString('ar-SA')}</div>
              
              <div class="stats">
                <div class="stat-box"><div class="stat-label">Ø§Ù„Ø¯Ø®Ù„</div><div class="stat-value green">${this.formatMoney(this.reportData?.income || 0)}</div></div>
                <div class="stat-box"><div class="stat-label">Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</div><div class="stat-value red">${this.formatMoney(this.reportData?.expenses || 0)}</div></div>
                <div class="stat-box"><div class="stat-label">Ø§Ù„Ø§Ø¯Ø®Ø§Ø±</div><div class="stat-value ${(this.reportData?.savings || 0) >= 0 ? 'green' : 'red'}">${this.formatMoney(this.reportData?.savings || 0)}</div></div>
                <div class="stat-box"><div class="stat-label">Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</div><div class="stat-value blue">${this.reportData?.transactionCount || 0}</div></div>
              </div>
              
              <div class="categories">
                <h2>Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª Ø­Ø³Ø¨ Ø§Ù„ØªØµÙ†ÙŠÙ</h2>
                ${(this.reportData?.chartData || []).map(item => 
                  `<div class="cat-item"><span>${item.category}</span><span>${this.formatMoney(item.amount)}</span></div>`
                ).join('')}
              </div>
              
              <div class="footer">SJA Money Tracker - ${new Date().toLocaleDateString('ar-SA')}</div>
            </body>
            </html>
          `;
          
          // Open print dialog (user can save as PDF)
          const printWindow = window.open('', '_blank');
          printWindow.document.write(printContent);
          printWindow.document.close();
          printWindow.focus();
          
          setTimeout(() => {
            printWindow.print();
            this.showToast('Ø§Ø®ØªØ± "Ø­ÙØ¸ ÙƒÙ€ PDF" Ù…Ù† Ù†Ø§ÙØ°Ø© Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©', 'success');
          }, 500);
        },
        
        exportReportCSV() {
          if (!this.reportData) {
            this.showToast('Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªÙ‚Ø±ÙŠØ± Ù„Ù„ØªØµØ¯ÙŠØ±', 'error');
            return;
          }
          
          const periodNames = { daily: 'daily', weekly: 'weekly', monthly: 'monthly' };
          const period = periodNames[this.reportPeriod] || 'report';
          
          // Create CSV content
          let csv = 'Ø§Ù„ØªØµÙ†ÙŠÙ,Ø§Ù„Ù…Ø¨Ù„Øº\n';
          (this.reportData?.chartData || []).forEach(item => {
            csv += `"${item.category}",${item.amount}\n`;
          });
          csv += `\n"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¯Ø®Ù„",${this.reportData?.income || 0}\n`;
          csv += `"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª",${this.reportData?.expenses || 0}\n`;
          csv += `"Ø§Ù„Ø§Ø¯Ø®Ø§Ø±",${this.reportData?.savings || 0}\n`;
          csv += `"Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª",${this.reportData?.transactionCount || 0}\n`;
          
          const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
          const link = document.createElement('a');
          link.href = URL.createObjectURL(blob);
          link.download = `report_${period}_${new Date().toISOString().split('T')[0]}.csv`;
          link.click();
          
          this.showToast('ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨Ù†Ø¬Ø§Ø­', 'success');
        },
        
        printReport() {
          if (!this.reportData) {
            this.showToast('Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªÙ‚Ø±ÙŠØ± Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©', 'error');
            return;
          }
          this.exportReportPDF(); // Same as PDF - opens print dialog
        },
        
        exportAllDataPDF() {
          this.showToast('Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ PDF...', 'info');
          
          // Create comprehensive PDF with all transactions
          const printContent = `
            <!DOCTYPE html>
            <html lang="ar" dir="rtl">
            <head>
              <meta charset="utf-8">
              <title>ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª - SJA Money Tracker</title>
              <style>
                body { font-family: 'Segoe UI', Tahoma, Arial, sans-serif; padding: 40px; direction: rtl; }
                h1 { color: #16a34a; margin-bottom: 10px; }
                .date { color: #666; margin-bottom: 30px; }
                .summary { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 30px; }
                .summary-box { border: 1px solid #e5e7eb; border-radius: 12px; padding: 20px; text-align: center; }
                .summary-label { font-size: 14px; color: #666; margin-bottom: 5px; }
                .summary-value { font-size: 24px; font-weight: bold; }
                .green { color: #16a34a; }
                .red { color: #dc2626; }
                table { width: 100%; border-collapse: collapse; margin-top: 30px; }
                th, td { border: 1px solid #e5e7eb; padding: 12px; text-align: right; }
                th { background: #f9fafb; font-weight: bold; }
                tr:nth-child(even) { background: #f9fafb; }
                .footer { margin-top: 50px; text-align: center; color: #999; font-size: 12px; }
                @media print { body { padding: 20px; } }
              </style>
            </head>
            <body>
              <h1>ğŸ“Š ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©</h1>
              <div class="date">Ø§Ù„ØªØ§Ø±ÙŠØ®: ${new Date().toLocaleDateString('ar-SA')}</div>
              
              <div class="summary">
                <div class="summary-box"><div class="summary-label">Ø§Ù„Ø±ØµÙŠØ¯</div><div class="summary-value green">${this.formatMoney(this.stats.balance)}</div></div>
                <div class="summary-box"><div class="summary-label">Ø§Ù„Ø¯Ø®Ù„</div><div class="summary-value green">${this.formatMoney(this.stats.income)}</div></div>
                <div class="summary-box"><div class="summary-label">Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</div><div class="summary-value red">${this.formatMoney(this.stats.expense)}</div></div>
                <div class="summary-box"><div class="summary-label">Ø§Ù„ØªÙˆÙÙŠØ±</div><div class="summary-value">${this.formatMoney(this.stats.savings)}</div></div>
              </div>
              
              <h2>Ø¢Ø®Ø± ${Math.min(this.allTransactions.length, 50)} Ù…Ø¹Ø§Ù…Ù„Ø©</h2>
              <table>
                <thead>
                  <tr>
                    <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                    <th>Ø§Ù„ØªØ§Ø¬Ø±</th>
                    <th>Ø§Ù„ØªØµÙ†ÙŠÙ</th>
                    <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
                  </tr>
                </thead>
                <tbody>
                  ${this.allTransactions.slice(0, 50).map(tx => `
                    <tr>
                      <td>${this.formatDate(tx.date)}</td>
                      <td>${tx.merchant || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</td>
                      <td>${tx.category || 'Ø£Ø®Ø±Ù‰'}</td>
                      <td class="${tx.amount > 0 ? 'red' : 'green'}">${this.formatMoney(Math.abs(tx.amount))}</td>
                    </tr>
                  `).join('')}
                </tbody>
              </table>
              
              <div class="footer">SJA Money Tracker - ØªÙ… Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ ÙÙŠ ${new Date().toLocaleString('ar-SA')}</div>
            </body>
            </html>
          `;
          
          const printWindow = window.open('', '_blank');
          printWindow.document.write(printContent);
          printWindow.document.close();
          printWindow.focus();
          
          setTimeout(() => {
            printWindow.print();
            this.showToast('Ø§Ø®ØªØ± "Ø­ÙØ¸ ÙƒÙ€ PDF" Ù…Ù† Ù†Ø§ÙØ°Ø© Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©', 'success');
          }, 500);
        },
        // ============ END REPORT EXPORT ============

        exportData() {
          this.showToast('Ø¬Ø§Ø±ÙŠ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...', 'info');
          google.script.run
            .withSuccessHandler(csv => {
              const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
              const link = document.createElement('a');
              const url = URL.createObjectURL(blob);
              link.setAttribute('href', url);
              link.setAttribute('download', 'transactions_' + new Date().toISOString().split('T')[0] + '.csv');
              link.style.visibility = 'hidden';
              document.body.appendChild(link);
              link.click();
              document.body.removeChild(link);
              this.showToast('ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
            })
            .withFailureHandler(err => {
              this.showToast('ÙØ´Ù„ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'error');
            })
            .SOV1_UI_exportData();
        },
        
        confirmDeleteAccount() {
          if (confirm('âš ï¸ ØªØ­Ø°ÙŠØ±: Ø³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø¨Ø´ÙƒÙ„ Ù†Ù‡Ø§Ø¦ÙŠ. Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ\\n\\nØ§ÙƒØªØ¨ \"Ù†Ø¹Ù…\" Ù„Ù„ØªØ£ÙƒÙŠØ¯.')) {
            const confirmation = prompt('Ø§ÙƒØªØ¨ \"Ø­Ø°Ù\" Ù„Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ:');
            if (confirmation === 'Ø­Ø°Ù') {
              this.deleteAccount();
            } else {
              this.showToast('ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø­Ø°Ù', 'info');
            }
          }
        },
        
        deleteAccount() {
          this.showToast('Ø¬Ø§Ø±ÙŠ Ø­Ø°Ù Ø§Ù„Ø­Ø³Ø§Ø¨...', 'info');
          google.script.run
            .withSuccessHandler(result => {
              alert('âœ… ØªÙ… Ø­Ø°Ù Ø­Ø³Ø§Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­. Ø³ÙŠØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø©.');
              window.location.reload();
            })
            .withFailureHandler(err => {
              this.showToast('ÙØ´Ù„ Ø­Ø°Ù Ø§Ù„Ø­Ø³Ø§Ø¨: ' + err.message, 'error');
            })
            .SOV1_UI_deleteAccount();
        },
        
        searchTransactions() {
          if (!this.searchQuery || this.searchQuery.trim() === '') {
            this.filteredTransactions = this.allTransactions;
          } else {
            const query = this.searchQuery.toLowerCase();
            this.filteredTransactions = this.allTransactions.filter(tx => 
              tx.merchant.toLowerCase().includes(query) ||
              tx.category.toLowerCase().includes(query) ||
              String(tx.amount).includes(query)
            );
          }
          this.transactions = this.filteredTransactions.slice(0, 50);
        },
        
        openEditBudgetModal(budget) {
          this.editingBudget = budget;
          this.newBudget = { category: budget.category, limit: budget.limit };
          this.showBudgetModal = true;
        },
        
        openEditTransactionModal(tx) {
          this.editingTransaction = tx;
          this.newTransaction = {
            rowId: tx.id + 2,
            merchant: tx.merchant,
            category: tx.category,
            amount: tx.amount,
            notes: tx.notes || ''
          };
          this.showEditTransactionModal = true;
        },
        
        saveEditedTransaction() {
          // Validation
          if (!this.newTransaction.merchant || this.newTransaction.merchant.trim() === '') {
            this.showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„ØªØ§Ø¬Ø±', 'error');
            return;
          }
          
          if (!this.isPositiveNumber(this.newTransaction.amount)) {
            this.showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­ Ø£ÙƒØ¨Ø± Ù…Ù† ØµÙØ±', 'error');
            return;
          }
          
          if (!this.newTransaction.category || this.newTransaction.category.trim() === '') {
            this.showToast('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØªØµÙ†ÙŠÙ', 'error');
            return;
          }
          
          this.loading = true;
          google.script.run
            .withSuccessHandler(result => {
              this.loading = false;
              this.showEditTransactionModal = false;
              this.showToast('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­');
              this.refreshData();
            })
            .withFailureHandler(err => {
              this.loading = false;
              this.showToast('ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù…Ù„ÙŠØ©', 'error');
            })
            .SOV1_UI_updateTransaction(this.newTransaction.rowId, {
              merchant: this.newTransaction.merchant,
              category: this.newTransaction.category,
              amount: parseFloat(this.newTransaction.amount),
              notes: this.newTransaction.notes
            });
        }
      }
    }
  </script>
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
</head>
<body class="text-gray-800" x-data="appData()" x-init="init()" x-cloak>
  
  <!-- Setup Wizard Overlay -->
  <div x-show="setupMode" class="fixed inset-0 bg-gradient-to-br from-blue-600 to-purple-700 z-50 flex items-center justify-center p-4" x-transition>
    <div class="bg-white rounded-3xl shadow-2xl max-w-2xl w-full p-8">
      <!-- Header -->
      <div class="text-center mb-8">
        <div class="text-6xl mb-4">ğŸ’°</div>
        <h1 class="text-3xl font-extrabold text-gray-900 mb-2">Ù…Ø±Ø­Ø¨Ø§Ù‹ ÙÙŠ SJA Money Tracker</h1>
        <p class="text-gray-600">Ø¯Ø¹Ù†Ø§ Ù†Ø¹Ø¯ Ù†Ø¸Ø§Ù…Ùƒ ÙÙŠ Ø¯Ù‚Ø§Ø¦Ù‚!</p>
      </div>

      <!-- Error Alert -->
      <div x-show="errorMessage" class="mb-6 p-4 bg-red-50 border border-red-200 rounded-xl text-red-700 text-sm" x-transition>
        <strong>âš ï¸ Ø®Ø·Ø£:</strong> <span x-text="errorMessage"></span>
      </div>

      <!-- Setup Status -->
      <div class="space-y-4 mb-8">
        <div class="flex items-center gap-3 p-4 rounded-xl" :class="configStatus.hasSheet ? 'bg-green-50' : 'bg-gray-50'">
          <span x-show="configStatus.hasSheet" class="text-2xl">âœ…</span>
          <span x-show="!configStatus.hasSheet" class="text-2xl">âš ï¸</span>
          <div class="flex-1">
            <div class="font-bold text-gray-900">Google Sheets</div>
            <div class="text-sm text-gray-600">ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</div>
          </div>
          <span x-show="configStatus.hasSheet" class="text-xs text-green-600 font-bold">Ø¬Ø§Ù‡Ø²</span>
          <span x-show="!configStatus.hasSheet" class="text-xs text-gray-500 font-bold">Ù…Ø·Ù„ÙˆØ¨</span>
        </div>

        <div class="flex items-center gap-3 p-4 rounded-xl" :class="configStatus.hasTelegram ? 'bg-green-50' : 'bg-gray-50'">
          <span x-show="configStatus.hasTelegram" class="text-2xl">âœ…</span>
          <span x-show="!configStatus.hasTelegram" class="text-2xl">âš ï¸</span>
          <div class="flex-1">
            <div class="font-bold text-gray-900">Telegram Bot</div>
            <div class="text-sm text-gray-600">Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„</div>
          </div>
          <span x-show="configStatus.hasTelegram" class="text-xs text-green-600 font-bold">Ù…ØªØµÙ„</span>
          <span x-show="!configStatus.hasTelegram" class="text-xs text-gray-500 font-bold">Ù…Ø·Ù„ÙˆØ¨</span>
        </div>

        <div class="flex items-center gap-3 p-4 rounded-xl" :class="configStatus.hasAI ? 'bg-green-50' : 'bg-yellow-50'">
          <span x-show="configStatus.hasAI" class="text-2xl">âœ…</span>
          <span x-show="!configStatus.hasAI" class="text-2xl">â„¹ï¸</span>
          <div class="flex-1">
            <div class="font-bold text-gray-900">AI Classification</div>
            <div class="text-sm text-gray-600">ØªØµÙ†ÙŠÙ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª</div>
          </div>
          <span x-show="configStatus.hasAI" class="text-xs text-green-600 font-bold">Ù…ÙØ¹Ù‘Ù„</span>
          <span x-show="!configStatus.hasAI" class="text-xs text-yellow-600 font-bold">Ø§Ø®ØªÙŠØ§Ø±ÙŠ</span>
        </div>
      </div>

      <!-- Quick Start Guide -->
      <div class="bg-blue-50 border border-blue-200 rounded-xl p-6 mb-6">
        <h3 class="font-bold text-blue-900 mb-3 flex items-center gap-2">
          <span>ğŸ“š</span> Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø³Ø±ÙŠØ¹
        </h3>
        <ol class="space-y-2 text-sm text-blue-800">
          <li class="flex gap-2"><span class="font-bold">1.</span> Ø§ÙØªØ­ Google Sheets ÙˆØ§Ù†Ø³Ø® Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ù„Ù (SHEET_ID)</li>
          <li class="flex gap-2"><span class="font-bold">2.</span> Ø£Ù†Ø´Ø¦ Ø¨ÙˆØª ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… Ø¹Ø¨Ø± @BotFather</li>
          <li class="flex gap-2"><span class="font-bold">3.</span> Ø§Ù„ØµÙ‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Script Properties</li>
          <li class="flex gap-2"><span class="font-bold">4.</span> Ø£Ø±Ø³Ù„ /start Ù„Ù„Ø¨ÙˆØª Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Chat ID</li>
        </ol>
      </div>

      <!-- Actions -->
      <div class="flex gap-3">
        <button @click="skipSetup()" class="flex-1 px-6 py-3 border-2 border-gray-300 rounded-xl font-bold text-gray-700 hover:bg-gray-50 transition">
          ØªØ®Ø·ÙŠ Ø§Ù„Ø¢Ù†
        </button>
        <button @click="page='setup'; setupMode=false" class="flex-1 px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl font-bold hover:shadow-lg transition">
          ÙØªØ­ Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯
        </button>
      </div>

      <div class="mt-4 text-center">
        <a href="https://github.com/your-repo/wiki/setup" target="_blank" class="text-sm text-blue-600 hover:underline">
          ğŸ“– Ø´Ø§Ù‡Ø¯ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ
        </a>
      </div>
    </div>
  </div>
  
  <!-- Sidebar (Desktop) -->
  <div class="fixed inset-y-0 right-0 w-64 bg-white shadow-xl hidden lg:flex flex-col z-20">
    <div class="h-20 flex items-center justify-center border-b border-gray-100">
      <div class="text-2xl font-extrabold text-green-600 tracking-tight flex items-center gap-2">
        <span class="text-green-600 font-black">SJA</span>
      </div>
    </div>
    <nav class="flex-1 px-4 py-6 space-y-2">
      <a href="#" @click.prevent="page='dashboard'" :class="{'bg-green-50 text-green-700': page==='dashboard', 'text-gray-600 hover:bg-gray-50': page!=='dashboard'}" class="flex items-center gap-3 px-4 py-3 rounded-xl font-medium transition-colors">
        <span>ğŸ“Š</span> Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
      </a>
      <a href="#" @click.prevent="page='transactions'" :class="{'bg-green-50 text-green-700': page==='transactions', 'text-gray-600 hover:bg-gray-50': page!=='transactions'}" class="flex items-center gap-3 px-4 py-3 rounded-xl font-medium transition-colors">
        <span>ğŸ“‹</span> Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª
      </a>
      <a href="#" @click.prevent="page='budgets'" :class="{'bg-green-50 text-green-700': page==='budgets', 'text-gray-600 hover:bg-gray-50': page!=='budgets'}" class="flex items-center gap-3 px-4 py-3 rounded-xl font-medium transition-colors">
        <span>ğŸ“‰</span> Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ§Øª
      </a>
      <a href="#" @click.prevent="page='reports'" :class="{'bg-green-50 text-green-700': page==='reports', 'text-gray-600 hover:bg-gray-50': page!=='reports'}" class="flex items-center gap-3 px-4 py-3 rounded-xl font-medium transition-colors">
        <span>ğŸ“Š</span> Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±
      </a>
      <a href="#" @click.prevent="page='accounts'" :class="{'bg-green-50 text-green-700': page==='accounts', 'text-gray-600 hover:bg-gray-50': page!=='accounts'}" class="flex items-center gap-3 px-4 py-3 rounded-xl font-medium transition-colors">
        <span>ğŸ¦</span> Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª
      </a>
      <a href="#" @click.prevent="page='settings'" :class="{'bg-green-50 text-green-700': page==='settings', 'text-gray-600 hover:bg-gray-50': page!=='settings'}" class="flex items-center gap-3 px-4 py-3 rounded-xl font-medium transition-colors">
        <span>âš™ï¸</span> Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
      </a>
    </nav>
    <div class="p-4 border-t border-gray-100">
      <div class="flex items-center gap-3 px-4 py-3">
        <div class="w-10 h-10 rounded-full bg-green-100 flex items-center justify-center text-green-700 font-bold" x-text="(userSettings.user_name || 'Ù…Ø³ØªØ®Ø¯Ù…')[0]"></div>
        <div>
          <div class="text-sm font-bold" x-text="userSettings.user_name || 'Ù…Ø³ØªØ®Ø¯Ù…'"></div>
          <div class="text-xs text-gray-500" x-text="userSettings.user_email || ''"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Mobile Header -->
  <div class="lg:hidden fixed top-0 inset-x-0 h-16 bg-white shadow-sm z-20 flex items-center justify-between px-4">
    <div class="text-xl font-extrabold text-green-600">SJA</div>
    <button @click="mobileMenu = !mobileMenu" class="p-2 rounded-lg bg-gray-100 text-gray-600 focus:outline-none">
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>
  </div>
  
  <!-- Mobile Menu Overlay -->
  <div x-show="mobileMenu" class="fixed inset-0 bg-black bg-opacity-50 z-30 lg:hidden" @click="mobileMenu = false" x-transition.opacity></div>
  <div x-show="mobileMenu" class="fixed inset-y-0 right-0 w-64 bg-white z-40 lg:hidden shadow-2xl flex flex-col" 
       x-transition:enter="transition ease-out duration-300" x-transition:enter-start="translate-x-full" x-transition:enter-end="translate-x-0"
       x-transition:leave="transition ease-in duration-200" x-transition:leave-start="translate-x-0" x-transition:leave-end="translate-x-full">
       <div class="h-16 flex items-center justify-between px-4 border-b">
         <span class="font-bold text-lg">Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</span>
         <button @click="mobileMenu = false" class="text-gray-500">&times;</button>
       </div>
       <nav class="flex-1 p-4 space-y-2">
         <!-- Mobile Links (same as desktop) -->
         <a href="#" @click="page='dashboard'; mobileMenu=false" :class="{'bg-green-50 text-green-700': page==='dashboard'}" class="flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 font-medium">
           <span>ğŸ“Š</span> Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
         </a>
         <a href="#" @click="page='transactions'; mobileMenu=false" :class="{'bg-green-50 text-green-700': page==='transactions'}" class="flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 font-medium">
           <span>ğŸ“‹</span> Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª
         </a>
         <a href="#" @click="page='budgets'; mobileMenu=false" :class="{'bg-green-50 text-green-700': page==='budgets'}" class="flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 font-medium">
           <span>ğŸ“‰</span> Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ§Øª
         </a>
         <a href="#" @click="page='reports'; mobileMenu=false" :class="{'bg-green-50 text-green-700': page==='reports'}" class="flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 font-medium">
           <span>ğŸ“Š</span> Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±
         </a>
         <a href="#" @click="page='accounts'; mobileMenu=false" :class="{'bg-green-50 text-green-700': page==='accounts'}" class="flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 font-medium">
           <span>ğŸ¦</span> Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª
         </a>
         <a href="#" @click="page='settings'; mobileMenu=false" :class="{'bg-green-50 text-green-700': page==='settings'}" class="flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-50 font-medium">
           <span>âš™ï¸</span> Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
         </a>
       </nav>
  </div>

  <!-- Main Content -->
  <main class="lg:mr-64 min-h-screen pt-20 lg:pt-8 px-4 lg:px-8 pb-8 transition-all duration-300">
    
    <!-- Global Loading Overlay -->
    <div x-show="loading" x-transition.opacity class="fixed inset-0 bg-white/80 backdrop-blur-sm z-50 flex items-center justify-center">
      <div class="text-center">
        <div class="w-16 h-16 border-4 border-green-200 border-t-green-600 rounded-full animate-spin mx-auto mb-4"></div>
        <p class="text-gray-600 font-medium">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</p>
      </div>
    </div>

    <!-- Error Message Banner -->
    <div x-show="errorMessage" x-transition class="fixed top-4 left-1/2 transform -translate-x-1/2 z-40 max-w-md w-full mx-4">
      <div class="bg-red-500 text-white px-6 py-4 rounded-lg shadow-lg flex items-start gap-3">
        <span class="text-2xl">âš ï¸</span>
        <div class="flex-1">
          <div class="font-bold mb-1">Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„</div>
          <div class="text-sm" x-text="errorMessage"></div>
        </div>
        <button @click="errorMessage = ''" class="text-white/80 hover:text-white">&times;</button>
      </div>
    </div>

    <!-- PAGE: DASHBOARD -->
    <div x-show="page === 'dashboard'" x-transition.opacity>
      <header class="flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8">
        <div>
          <h1 class="text-2xl font-bold text-gray-900">Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©</h1>
          <p class="text-gray-500 text-sm mt-1">Ø£Ù‡Ù„Ø§Ù‹ Ø¨ÙƒØŒ Ø¥Ù„ÙŠÙƒ Ù…Ù„Ø®ØµÙƒ Ø§Ù„Ù…Ø§Ù„ÙŠ Ù„Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±.</p>
        </div>
        <div class="flex gap-2">
           <button @click="refreshData()" class="px-4 py-2 bg-white border border-gray-200 rounded-lg text-sm font-medium hover:bg-gray-50 transition shadow-sm flex items-center gap-2">
             <span x-show="loading" class="animate-spin">â†»</span>
             <span>ØªØ­Ø¯ÙŠØ«</span>
           </button>
           <button @click="openAddModal()" class="px-4 py-2 bg-green-600 text-white rounded-lg text-sm font-medium hover:bg-green-700 transition shadow-lg shadow-green-200">
             + Ø¹Ù…Ù„ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©
           </button>
        </div>
      </header>

      <!-- KPI Grid -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
        <!-- Balance Card -->
        <div class="bg-gradient-to-br from-indigo-500 to-blue-600 rounded-2xl p-6 text-white shadow-lg shadow-blue-100 relative overflow-hidden group hover:scale-[1.02] transition-transform">
          <div class="absolute top-0 right-0 w-32 h-32 bg-white opacity-10 rounded-full -mr-16 -mt-16 group-hover:scale-150 transition-transform duration-700"></div>
          <div class="text-blue-100 text-sm font-medium mb-1">Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªÙˆÙØ±</div>
          <div class="text-3xl font-extrabold tracking-tight" x-text="formatMoney(stats.balance)">0.00</div>
          <div class="mt-4 flex items-center text-xs text-blue-100 bg-white/20 w-fit px-2 py-1 rounded-lg backdrop-blur-sm">
            <span>Ù…Ø¯Ø®Ø±Ø§Øª ØªØ±Ø§ÙƒÙ…ÙŠØ©</span>
          </div>
        </div>

        <!-- Income Card -->
        <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-shadow">
          <div class="flex items-center justify-between mb-2">
            <div class="text-gray-500 text-sm font-medium">Ø§Ù„Ø¯Ø®Ù„ Ø§Ù„Ø´Ù‡Ø±ÙŠ</div>
            <div class="w-8 h-8 rounded-full bg-green-50 flex items-center justify-center text-green-600">â†“</div>
          </div>
          <div class="text-2xl font-bold text-gray-900" x-text="formatMoney(stats.income)">0.00</div>
          <div class="mt-2 text-xs text-green-600 font-medium">+12% Ø¹Ù† Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ù…Ø§Ø¶ÙŠ</div>
        </div>

        <!-- Expense Card -->
        <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-shadow">
           <div class="flex items-center justify-between mb-2">
            <div class="text-gray-500 text-sm font-medium">Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</div>
            <div class="w-8 h-8 rounded-full bg-red-50 flex items-center justify-center text-red-600">â†‘</div>
          </div>
          <div class="text-2xl font-bold text-gray-900" x-text="formatMoney(stats.expense)">0.00</div>
          <div class="mt-2 text-xs text-red-600 font-medium">Ø¶Ù…Ù† Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©</div>
        </div>

         <!-- Savings Card -->
         <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-shadow">
           <div class="flex items-center justify-between mb-2">
            <div class="text-gray-500 text-sm font-medium">Ø§Ù„ØªÙˆÙÙŠØ±</div>
            <div class="w-8 h-8 rounded-full bg-purple-50 flex items-center justify-center text-purple-600">â˜…</div>
          </div>
          <div class="text-2xl font-bold text-gray-900" x-text="formatMoney(stats.savings)">0.00</div>
          <div class="mt-2 text-xs text-purple-600 font-medium">Ù…Ù…ØªØ§Ø²! ÙˆØ§ØµÙ„ Ø§Ù„ØªÙ‚Ø¯Ù….</div>
        </div>
      </div>

      <!-- Accounts Summary Section -->
      <div class="mt-8" x-show="accounts.length > 0">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-bold text-gray-800">ğŸ’³ Ø­Ø³Ø§Ø¨Ø§ØªÙŠ</h3>
          <a href="#" @click.prevent="page = 'accounts'" class="text-sm text-green-600 hover:underline font-medium">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</a>
        </div>
        <div class="grid sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
          <template x-for="account in accounts.slice(0, 4)" :key="account.name">
            <div class="bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl p-4 text-white shadow-lg hover:shadow-xl transition-shadow">
              <div class="flex items-center justify-between mb-3">
                <span class="text-xl">
                  <span x-show="account.type === 'Ø¨Ù†Ùƒ' || !account.type">ğŸ¦</span>
                  <span x-show="account.type === 'Ø¨Ø·Ø§Ù‚Ø©'">ğŸ’³</span>
                  <span x-show="account.type === 'Ù…Ø­ÙØ¸Ø©'">ğŸ‘›</span>
                </span>
                <span class="text-xs bg-white/20 px-2 py-1 rounded-full" x-text="account.bank || account.type || 'Ø­Ø³Ø§Ø¨'"></span>
              </div>
              <div class="font-bold text-sm truncate mb-2" x-text="account.name">Ø§Ø³Ù… Ø§Ù„Ø­Ø³Ø§Ø¨</div>
              <div class="text-lg font-bold" x-text="formatMoney(account.balance || 0)">0.00</div>
              <div x-show="account.lastUpdate" class="text-xs opacity-75 mt-2" x-text="'Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: ' + formatDate(account.lastUpdate)"></div>
            </div>
          </template>
        </div>
        <div x-show="accounts.length > 4" class="mt-3 text-center">
          <button @click="page = 'accounts'" class="text-sm text-green-600 hover:underline font-medium">
            Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª (<span x-text="accounts.length"></span>)
          </button>
        </div>
      </div>

      <!-- Recent Transactions & Charts -->
      <div class="grid lg:grid-cols-3 gap-8">
        <!-- Recent Transactions List -->
        <div class="lg:col-span-2 bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
          <div class="px-6 py-4 border-b border-gray-50 flex items-center justify-between bg-gray-50/50">
            <h3 class="font-bold text-gray-800">Ø¢Ø®Ø± Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</h3>
            <a href="#" @click.prevent="showAllTransactions()" class="text-xs text-green-600 font-semibold hover:underline">Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„</a>
          </div>
          <div class="divide-y divide-gray-50">
             <!-- Loop Transactions -->
             <template x-for="tx in transactions.slice(0, 10)" :key="tx.id">
               <div class="flex items-center justify-between p-4 hover:bg-gray-50 transition-colors group cursor-pointer">
                 <div class="flex items-center gap-4">
                   <div class="w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-xl shadow-inner group-hover:scale-110 transition-transform">
                     <span x-text="getCategoryIcon(tx.category)">ğŸ›’</span>
                   </div>
                   <div>
                     <div class="font-bold text-gray-900 text-sm" x-text="tx.merchant">Subway</div>
                     <div class="text-xs text-gray-500 mt-0.5" x-text="formatDate(tx.date)">Today, 10:23 AM</div>
                   </div>
                 </div>
                 <div class="text-right">
                   <div class="font-bold text-sm" :class="tx.amount > 0 ? 'text-red-500' : 'text-green-600'" x-text="formatMoney(Math.abs(tx.amount))">-25.00</div>
                   <div class="text-[10px] uppercase tracking-wider font-semibold text-gray-400 mt-0.5" x-text="tx.category">FOOD</div>
                 </div>
               </div>
             </template>
             <div x-show="transactions.length === 0" class="p-8 text-center">
               <div class="text-4xl mb-2">ğŸ“‹</div>
               <p class="text-gray-400 mb-3">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù…Ù„ÙŠØ§Øª Ø­Ø¯ÙŠØ«Ø©</p>
               <button @click="currentPage = 'transactions'" class="text-sm px-4 py-2 bg-green-500 text-white rounded-lg font-medium hover:bg-green-600 transition">
                 â• Ø¥Ø¶Ø§ÙØ© Ø¹Ù…Ù„ÙŠØ©
               </button>
             </div>
          </div>
        </div>

        <!-- Mini Budget/Stats -->
        <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6">
          <h3 class="font-bold text-gray-800 mb-6">ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</h3>
          
          <!-- Show message if no budgets -->
          <div x-show="budgets.length === 0" class="text-center py-8">
            <div class="text-4xl mb-3">ğŸ“Š</div>
            <p class="text-sm text-gray-400 mb-3">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙŠØ²Ø§Ù†ÙŠØ§Øª Ù…Ø­Ø¯Ø¯Ø©</p>
            <button @click="currentPage = 'budgets'" class="text-sm px-4 py-2 bg-green-500 text-white rounded-lg font-medium hover:bg-green-600 transition">
              â• Ø¥Ø¶Ø§ÙØ© Ù…ÙŠØ²Ø§Ù†ÙŠØ©
            </button>
          </div>
          
          <!-- Show top 3 budgets -->
          <template x-if="budgets.length > 0">
            <div class="space-y-4">
              <template x-for="(budget, idx) in budgets.slice(0, 3)" :key="idx">
                <div class="flex items-center justify-between text-sm">
                  <div class="flex items-center gap-2">
                    <span class="w-2 h-2 rounded-full" 
                          :class="idx === 0 ? 'bg-green-500' : idx === 1 ? 'bg-blue-500' : 'bg-purple-500'"></span>
                    <span x-text="budget.category">Ø§Ù„ØªØµÙ†ÙŠÙ</span>
                  </div>
                  <span class="font-bold" x-text="formatMoney(budget.spent)">0</span>
                </div>
              </template>
            </div>
          </template>
        </div>
      </div>
    </div>

    <!-- PAGE: TRANSACTIONS -->
    <div x-show="page === 'transactions'" x-transition.opacity>
      <header class="flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6">
        <div>
          <h1 class="text-2xl font-bold text-gray-900">Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©</h1>
          <p class="text-gray-500 text-sm mt-1">Ø¬Ù…ÙŠØ¹ Ù…Ø¹Ø§Ù…Ù„Ø§ØªÙƒ Ø§Ù„Ù…Ø§Ù„ÙŠØ© ÙÙŠ Ù…ÙƒØ§Ù† ÙˆØ§Ø­Ø¯</p>
        </div>
        <button @click="refreshData()" class="px-4 py-2 bg-green-600 text-white rounded-lg text-sm font-medium hover:bg-green-700 transition">
          ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
        </button>
      </header>
      
      <!-- Search Bar -->
      <div class="mb-6 bg-white rounded-xl shadow-sm border border-gray-100 p-4">
        <div class="flex gap-3">
          <div class="flex-1 relative">
            <input 
              type="text" 
              x-model="searchQuery"
              @input="searchTransactions()"
              placeholder="Ø§Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª... (Ø§Ù„ØªØ§Ø¬Ø±ØŒ Ø§Ù„ØªØµÙ†ÙŠÙØŒ Ø§Ù„Ù…Ø¨Ù„Øº)"
              class="w-full px-4 py-3 pr-12 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
            >
            <span class="absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400 text-xl">ğŸ”</span>
          </div>
          <button 
            @click="searchQuery = ''; searchTransactions()"
            x-show="searchQuery"
            class="px-6 py-3 bg-gray-100 hover:bg-gray-200 rounded-lg transition font-medium text-gray-700"
          >
            Ù…Ø³Ø­
          </button>
        </div>
        <div x-show="searchQuery" class="mt-2 text-sm text-gray-600">
          <span x-text="'Ø¹Ø¯Ø¯ Ø§Ù„Ù†ØªØ§Ø¦Ø¬: ' + transactions.length"></span>
        </div>
      </div>

      <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
        <div class="overflow-x-auto">
          <table class="w-full">
            <thead class="bg-gray-50 border-b border-gray-100">
              <tr>
                <th class="px-6 py-4 text-right text-xs font-bold text-gray-600 uppercase">Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                <th class="px-6 py-4 text-right text-xs font-bold text-gray-600 uppercase">Ø§Ù„ØªØ§Ø¬Ø±</th>
                <th class="px-6 py-4 text-right text-xs font-bold text-gray-600 uppercase">Ø§Ù„ØªØµÙ†ÙŠÙ</th>
                <th class="px-6 py-4 text-right text-xs font-bold text-gray-600 uppercase">Ø§Ù„Ù…Ø¨Ù„Øº</th>
                <th class="px-6 py-4 text-center text-xs font-bold text-gray-600 uppercase">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-50">
              <template x-for="tx in transactions" :key="tx.id">
                <tr class="hover:bg-gray-50 transition-colors">
                  <td class="px-6 py-4 text-sm text-gray-600" x-text="formatDate(tx.date)"></td>
                  <td class="px-6 py-4">
                    <div class="flex items-center gap-3">
                      <span class="text-xl" x-text="getCategoryIcon(tx.category)"></span>
                      <span class="font-medium text-gray-900" x-text="tx.merchant"></span>
                    </div>
                  </td>
                  <td class="px-6 py-4">
                    <span class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-xs font-medium" x-text="tx.category"></span>
                  </td>
                  <td class="px-6 py-4">
                    <span class="font-bold" :class="tx.amount > 0 ? 'text-red-600' : 'text-green-600'" x-text="formatMoney(Math.abs(tx.amount))"></span>
                  </td>
                  <td class="px-6 py-4">
                    <div class="flex items-center justify-center gap-2">
                      <button @click="openEditTransactionModal(tx)" class="p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition" title="ØªØ¹Ø¯ÙŠÙ„">
                        âœï¸
                      </button>
                      <button @click="deleteTransaction(tx)" class="p-2 text-red-600 hover:bg-red-50 rounded-lg transition" title="Ø­Ø°Ù">
                        ğŸ—‘ï¸
                      </button>
                    </div>
                  </td>
                </tr>
              </template>
            </tbody>
          </table>
        </div>
        <div x-show="transactions.length === 0" class="p-12 text-center">
          <div class="text-6xl mb-4">ğŸ“‹</div>
          <p class="text-gray-500 text-lg mb-6">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù…Ù„ÙŠØ§Øª Ù„Ø¹Ø±Ø¶Ù‡Ø§</p>
          <button @click="showAddModal = true" class="px-6 py-3 bg-green-500 text-white rounded-xl font-bold hover:bg-green-600 transition shadow-lg">
            â• Ø¥Ø¶Ø§ÙØ© Ø£ÙˆÙ„ Ø¹Ù…Ù„ÙŠØ©
          </button>
        </div>
      </div>
    </div>

    <!-- PAGE: BUDGETS -->
    <div x-show="page === 'budgets'" x-transition.opacity>
      <header class="flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8">
        <div>
          <h1 class="text-2xl font-bold text-gray-900">Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ§Øª</h1>
          <p class="text-gray-500 text-sm mt-1">ØªØªØ¨Ø¹ Ù…ØµØ±ÙˆÙØ§ØªÙƒ Ø­Ø³Ø¨ Ø§Ù„ØªØµÙ†ÙŠÙ</p>
        </div>
        <button @click="refreshData()" class="px-4 py-2 bg-green-600 text-white rounded-lg text-sm font-medium hover:bg-green-700 transition">
          ØªØ­Ø¯ÙŠØ«
        </button>
      </header>

      <!-- No budgets message -->
      <div x-show="budgets.length === 0" class="bg-white rounded-2xl shadow-sm border border-gray-100 p-12 text-center">
        <div class="text-6xl mb-4">ğŸ“Š</div>
        <h3 class="text-xl font-bold text-gray-900 mb-2">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙŠØ²Ø§Ù†ÙŠØ§Øª</h3>
        <p class="text-gray-600 mb-6">Ø§Ø¨Ø¯Ø£ Ø¨Ø¥Ø¶Ø§ÙØ© Ù…ÙŠØ²Ø§Ù†ÙŠØ§Øª Ù„ØªØªØ¨Ø¹ Ù…ØµØ±ÙˆÙØ§ØªÙƒ Ø­Ø³Ø¨ Ø§Ù„ØªØµÙ†ÙŠÙ</p>
        <button @click="showBudgetModal = true; editingBudget = null; newBudget = {category: '', limit: 0}" class="px-6 py-3 bg-green-600 text-white rounded-xl font-bold hover:bg-green-700 transition shadow-lg">
          â• Ø¥Ø¶Ø§ÙØ© Ø£ÙˆÙ„ Ù…ÙŠØ²Ø§Ù†ÙŠØ©
        </button>
      </div>

      <!-- Budgets Grid -->
      <div x-show="budgets.length > 0" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
        <template x-for="budget in budgets" :key="budget.category">
          <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6 hover:shadow-md transition">
            <div class="flex items-center justify-between mb-4">
              <div class="flex items-center gap-3">
                <span class="text-3xl" x-text="getCategoryIcon(budget.category)">ğŸ’¸</span>
                <div>
                  <h3 class="font-bold text-gray-900" x-text="budget.category">Ø§Ù„ØªØµÙ†ÙŠÙ</h3>
                  <p class="text-xs text-gray-500">Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ø´Ù‡Ø±ÙŠØ©</p>
                </div>
              </div>
            </div>
            <div class="mb-2">
              <div class="flex justify-between text-sm mb-1">
                <span class="text-gray-600">Ø§Ù„Ù…ØµØ±ÙˆÙ</span>
                <span class="font-bold text-gray-900">
                  <span x-text="formatMoney(budget.spent)">0</span> / 
                  <span x-text="formatMoney(budget.limit)">0</span>
                </span>
              </div>
              <div class="w-full bg-gray-200 rounded-full h-2">
                <div class="h-2 rounded-full transition-all" 
                     :class="getBudgetColor(getBudgetProgress(budget))"
                     :style="'width: ' + getBudgetProgress(budget) + '%'"></div>
              </div>
            </div>
            <p class="text-xs font-medium mt-3" 
               :class="getBudgetProgress(budget) >= 100 ? 'text-red-600' : getBudgetProgress(budget) >= 80 ? 'text-yellow-600' : 'text-green-600'">
              <template x-if="getBudgetProgress(budget) >= 100">
                <span>âœ— ØªØ¬Ø§ÙˆØ²Øª Ø¨Ù€ <span x-text="formatMoney(budget.spent - budget.limit)"></span></span>
              </template>
              <template x-if="getBudgetProgress(budget) < 100">
                <span>âœ“ Ø¨Ø§Ù‚ÙŠ <span x-text="formatMoney(budget.limit - budget.spent)"></span></span>
              </template>
            </p>
          </div>
        </template>
      </div>
    </div>

    <!-- PAGE: SETTINGS -->
    <div x-show="page === 'settings'" x-transition.opacity>
      <header class="mb-8">
        <h1 class="text-2xl font-bold text-gray-900">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h1>
        <p class="text-gray-500 text-sm mt-1">ØªØ®ØµÙŠØµ Ø§Ù„Ù†Ø¸Ø§Ù… Ø­Ø³Ø¨ Ø§Ø­ØªÙŠØ§Ø¬Ø§ØªÙƒ</p>
      </header>

      <div class="space-y-6">
        <!-- Account Section -->
        <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6">
          <h2 class="font-bold text-gray-900 mb-4 flex items-center gap-2">
            <span>ğŸ‘¤</span> Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø´Ø®ØµÙŠ
          </h2>
          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø§Ø³Ù…</label>
              <input type="text" x-model="userSettings.user_name" class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
              <input type="email" x-model="userSettings.user_email" class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">ÙŠÙˆÙ… Ù†Ø²ÙˆÙ„ Ø§Ù„Ø±Ø§ØªØ¨</label>
              <input type="number" x-model="userSettings.salary_day" min="1" max="31" class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
              <p class="text-xs text-gray-500 mt-1">ÙŠØ³ØªØ®Ø¯Ù… Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ© (Ù…Ù† 1 Ø¥Ù„Ù‰ 31)</p>
            </div>
            <div class="pt-4">
              <button @click="saveSettings()" class="w-full px-6 py-3 bg-green-600 text-white rounded-lg font-bold hover:bg-green-700 transition">
                ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª
              </button>
            </div>
          </div>
        </div>

        <!-- Notifications Section -->
        <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6">
          <h2 class="font-bold text-gray-900 mb-4 flex items-center gap-2">
            <span>ğŸ””</span> Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
          </h2>
          <div class="space-y-4">
            <div class="flex items-center justify-between">
              <div>
                <p class="font-medium text-gray-900">Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…</p>
                <p class="text-xs text-gray-500">Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø¹Ø¨Ø± Ø¨ÙˆØª ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…</p>
              </div>
              <label class="relative inline-flex items-center cursor-pointer">
                <input type="checkbox" x-model="userSettings.telegram_notifications" @change="saveSettings()" class="sr-only peer">
                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content=[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"></div>
              </label>
            </div>
            <div class="flex items-center justify-between">
              <div>
                <p class="font-medium text-gray-900">ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©</p>
                <p class="text-xs text-gray-500">Ø¥Ø´Ø¹Ø§Ø± Ø¹Ù†Ø¯ ØªØ¬Ø§ÙˆØ² Ø­Ø¯ Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©</p>
              </div>
              <label class="relative inline-flex items-center cursor-pointer">
                <input type="checkbox" x-model="userSettings.budget_alerts" @change="saveSettings()" class="sr-only peer">
                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"></div>
              </label>
            </div>
          </div>
        </div>

        <!-- System Section -->
        <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6">
          <h2 class="font-bold text-gray-900 mb-4 flex items-center gap-2">
            <span>âš™ï¸</span> Ø§Ù„Ù†Ø¸Ø§Ù…
          </h2>
          <div class="space-y-3">
            <div class="p-4 border border-gray-200 rounded-lg">
              <p class="font-medium text-gray-900 mb-3">ğŸ“¤ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</p>
              <div class="flex gap-2">
                <button @click="exportData()" class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition">
                  ğŸ“Š CSV
                </button>
                <button @click="exportAllDataPDF()" class="flex-1 px-4 py-2 bg-red-600 text-white rounded-lg text-sm font-medium hover:bg-red-700 transition">
                  ğŸ“„ PDF
                </button>
              </div>
            </div>
            <button @click="showPrivacyModal = true" class="w-full px-4 py-3 text-right border border-gray-200 rounded-lg hover:bg-gray-50 transition flex items-center justify-between">
              <span class="font-medium text-gray-900">Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©</span>
              <span class="text-gray-400">â†’</span>
            </button>
            <button @click="confirmDeleteAccount()" class="w-full px-4 py-3 text-right border border-red-200 rounded-lg hover:bg-red-50 transition flex items-center justify-between text-red-600">
              <span class="font-medium">Ø­Ø°Ù Ø§Ù„Ø­Ø³Ø§Ø¨</span>
              <span>âš ï¸</span>
            </button>
          </div>
        </div>

        <!-- Test Panel Section -->
        <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6">
          <h2 class="font-bold text-gray-900 mb-4 flex items-center gap-2">
            <span>ğŸ§ª</span> Ù„ÙˆØ­Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª
          </h2>
          <p class="text-sm text-gray-600 mb-4">Ø§Ø®ØªØ¨Ø± Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ù…Ù„Ù‡Ø§ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­</p>
          
          <div class="space-y-3">
            <!-- Test SMS Parsing -->
            <div class="p-4 border border-gray-200 rounded-lg">
              <div class="flex items-center justify-between mb-3">
                <div>
                  <p class="font-medium text-gray-900">ğŸ“ Ø§Ø®ØªØ¨Ø§Ø± ØªØ­Ù„ÙŠÙ„ SMS</p>
                  <p class="text-xs text-gray-500">ØªØ¬Ø±Ø¨Ø© Ù‚Ø±Ø§Ø¡Ø© Ø±Ø³Ø§Ù„Ø© Ø¨Ù†ÙƒÙŠØ©</p>
                </div>
                <button @click="testSMSParsing()" 
                        :disabled="testingStates.sms"
                        class="px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 disabled:bg-gray-400 transition">
                  <span x-show="!testingStates.sms">ØªØ´ØºÙŠÙ„</span>
                  <span x-show="testingStates.sms">Ø¬Ø§Ø±ÙŠ...</span>
                </button>
              </div>
              <div x-show="testResults.sms" class="mt-2 p-3 bg-gray-50 rounded text-xs font-mono overflow-auto max-h-40 whitespace-pre-wrap" x-text="testResults.sms"></div>
            </div>

            <!-- Test AI Classification -->
            <div class="p-4 border border-gray-200 rounded-lg">
              <div class="flex items-center justify-between mb-3">
                <div>
                  <p class="font-medium text-gray-900">ğŸ¤– Ø§Ø®ØªØ¨Ø§Ø± ØªØµÙ†ÙŠÙ AI</p>
                  <p class="text-xs text-gray-500">ØªØ¬Ø±Ø¨Ø© Ø§Ù„ØªØµÙ†ÙŠÙ Ø§Ù„Ø°ÙƒÙŠ</p>
                </div>
                <button @click="testAIClassification()" 
                        :disabled="testingStates.ai"
                        class="px-4 py-2 bg-purple-600 text-white rounded-lg text-sm font-medium hover:bg-purple-700 disabled:bg-gray-400 transition">
                  <span x-show="!testingStates.ai">ØªØ´ØºÙŠÙ„</span>
                  <span x-show="testingStates.ai">Ø¬Ø§Ø±ÙŠ...</span>
                </button>
              </div>
              <div x-show="testResults.ai" class="mt-2 p-3 bg-gray-50 rounded text-xs font-mono overflow-auto max-h-40 whitespace-pre-wrap" x-text="testResults.ai"></div>
            </div>

            <!-- Test Telegram -->
            <div class="p-4 border border-gray-200 rounded-lg">
              <div class="flex items-center justify-between mb-3">
                <div>
                  <p class="font-medium text-gray-900">ğŸ“± Ø§Ø®ØªØ¨Ø§Ø± ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…</p>
                  <p class="text-xs text-gray-500">Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© ØªØ¬Ø±ÙŠØ¨ÙŠØ©</p>
                </div>
                <button @click="testTelegram()" 
                        :disabled="testingStates.telegram"
                        class="px-4 py-2 bg-green-600 text-white rounded-lg text-sm font-medium hover:bg-green-700 disabled:bg-gray-400 transition">
                  <span x-show="!testingStates.telegram">ØªØ´ØºÙŠÙ„</span>
                  <span x-show="testingStates.telegram">Ø¬Ø§Ø±ÙŠ...</span>
                </button>
              </div>
              <div x-show="testResults.telegram" class="mt-2 p-3 bg-gray-50 rounded text-xs font-mono overflow-auto max-h-40 whitespace-pre-wrap" x-text="testResults.telegram"></div>
            </div>

            <!-- Test Full Flow -->
            <div class="p-4 border border-orange-200 bg-orange-50 rounded-lg">
              <div class="flex items-center justify-between mb-3">
                <div>
                  <p class="font-medium text-gray-900">âš¡ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ¯ÙÙ‚ Ø§Ù„ÙƒØ§Ù…Ù„</p>
                  <p class="text-xs text-gray-500">SMS â†’ AI â†’ Ø­ÙØ¸ â†’ Ø¥Ø´Ø¹Ø§Ø± (Ø´Ø§Ù…Ù„)</p>
                </div>
                <button @click="testFullFlow()" 
                        :disabled="testingStates.fullFlow"
                        class="px-4 py-2 bg-orange-600 text-white rounded-lg text-sm font-medium hover:bg-orange-700 disabled:bg-gray-400 transition">
                  <span x-show="!testingStates.fullFlow">ØªØ´ØºÙŠÙ„</span>
                  <span x-show="testingStates.fullFlow">Ø¬Ø§Ø±ÙŠ...</span>
                </button>
              </div>
              <div x-show="testResults.fullFlow" class="mt-2 p-3 bg-white rounded text-xs font-mono overflow-auto max-h-40 whitespace-pre-wrap" x-text="testResults.fullFlow"></div>
            </div>
          </div>
        </div>

        <div class="text-center text-sm text-gray-500 py-4">
          <p>SJA Money Tracker v2.1</p>
          <p class="mt-1">ØµÙÙ†Ø¹ Ø¨Ù€ â¤ï¸ ÙÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©</p>
        </div>
      </div>
    </div>

    <!-- PAGE: REPORTS -->
    <div x-show="page === 'reports'" x-transition.opacity>
      <header class="mb-8">
        <h1 class="text-2xl font-bold text-gray-900">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</h1>
        <p class="text-gray-500 text-sm mt-1">ØªÙ‚Ø§Ø±ÙŠØ± Ø´Ø§Ù…Ù„Ø© Ø¹Ù† Ù…ØµØ±ÙˆÙØ§ØªÙƒ ÙˆØ¯Ø®Ù„Ùƒ</p>
      </header>
      
      <div class="grid md:grid-cols-3 gap-4 mb-8">
        <button @click="loadReport('daily')" class="p-6 bg-white rounded-xl border-2 border-gray-200 hover:border-green-500 transition" :class="reportPeriod === 'daily' ? 'border-green-500 bg-green-50' : ''">
          <div class="text-3xl mb-2">ğŸ“…</div>
          <div class="font-bold text-gray-900">ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…</div>
        </button>
        <button @click="loadReport('weekly')" class="p-6 bg-white rounded-xl border-2 border-gray-200 hover:border-green-500 transition" :class="reportPeriod === 'weekly' ? 'border-green-500 bg-green-50' : ''">
          <div class="text-3xl mb-2">ğŸ“Š</div>
          <div class="font-bold text-gray-900">ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</div>
        </button>
        <button @click="loadReport('monthly')" class="p-6 bg-white rounded-xl border-2 border-gray-200 hover:border-green-500 transition" :class="reportPeriod === 'monthly' ? 'border-green-500 bg-green-50' : ''">
          <div class="text-3xl mb-2">ğŸ“ˆ</div>
          <div class="font-bold text-gray-900">ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±</div>
        </button>
      </div>
      
      <!-- Export Buttons -->
      <div x-show="reportData" class="flex gap-3 mb-6">
        <button @click="exportReportPDF()" class="px-4 py-2 bg-red-600 text-white rounded-lg text-sm font-medium hover:bg-red-700 transition flex items-center gap-2">
          ğŸ“„ ØªØµØ¯ÙŠØ± PDF
        </button>
        <button @click="exportReportCSV()" class="px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition flex items-center gap-2">
          ğŸ“Š ØªØµØ¯ÙŠØ± CSV
        </button>
        <button @click="printReport()" class="px-4 py-2 bg-gray-600 text-white rounded-lg text-sm font-medium hover:bg-gray-700 transition flex items-center gap-2">
          ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©
        </button>
      </div>

      <div x-show="!reportData" class="bg-white rounded-2xl shadow-sm border border-gray-100 p-8 text-center">
        <div class="text-6xl mb-4">ğŸ“Š</div>
        <h3 class="text-xl font-bold text-gray-900 mb-2">Ø§Ø®ØªØ± ÙØªØ±Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ±</h3>
        <p class="text-gray-600">Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø£Ø­Ø¯ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø£Ø¹Ù„Ø§Ù‡ Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</p>
      </div>
      
      <div x-show="reportData" class="space-y-6" id="reportContent">
        <!-- Stats -->
        <div class="grid md:grid-cols-4 gap-4">
          <div class="bg-white rounded-xl border border-gray-200 p-6">
            <div class="text-sm text-gray-600 mb-1">Ø§Ù„Ø¯Ø®Ù„</div>
            <div class="text-2xl font-bold text-green-600" x-text="formatMoney(reportData?.income || 0)">0</div>
          </div>
          <div class="bg-white rounded-xl border border-gray-200 p-6">
            <div class="text-sm text-gray-600 mb-1">Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</div>
            <div class="text-2xl font-bold text-red-600" x-text="formatMoney(reportData?.expenses || 0)">0</div>
          </div>
          <div class="bg-white rounded-xl border border-gray-200 p-6">
            <div class="text-sm text-gray-600 mb-1">Ø§Ù„Ø§Ø¯Ø®Ø§Ø±</div>
            <div class="text-2xl font-bold" :class="(reportData?.savings || 0) >= 0 ? 'text-green-600' : 'text-red-600'" x-text="formatMoney(reportData?.savings || 0)">0</div>
          </div>
          <div class="bg-white rounded-xl border border-gray-200 p-6">
            <div class="text-sm text-gray-600 mb-1">Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</div>
            <div class="text-2xl font-bold text-blue-600" x-text="reportData?.transactionCount || 0">0</div>
          </div>
        </div>
        
        <!-- Category Breakdown -->
        <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6">
          <h3 class="font-bold text-gray-900 mb-4">Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª Ø­Ø³Ø¨ Ø§Ù„ØªØµÙ†ÙŠÙ</h3>
          <div class="space-y-3">
            <template x-for="item in (reportData?.chartData || [])" :key="item.category">
              <div>
                <div class="flex justify-between text-sm mb-1">
                  <span x-text="item.category">Ø§Ù„ØªØµÙ†ÙŠÙ</span>
                  <span class="font-bold" x-text="formatMoney(item.amount)">0</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2">
                  <div class="h-2 rounded-full bg-green-500" :style="'width: ' + (item.amount / (reportData?.expenses || 1) * 100) + '%'"></div>
                </div>
              </div>
            </template>
          </div>
        </div>
      </div>
    </div>

    <!-- PAGE: ACCOUNTS -->
    <div x-show="page === 'accounts'" x-transition.opacity>
      <header class="mb-8 flex justify-between items-center">
        <div>
          <h1 class="text-2xl font-bold text-gray-900">Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø¨Ù†ÙƒÙŠØ©</h1>
          <p class="text-gray-500 text-sm mt-1">Ø¥Ø¯Ø§Ø±Ø© Ø­Ø³Ø§Ø¨Ø§ØªÙƒ ÙˆØ¨Ø·Ø§Ù‚Ø§ØªÙƒ Ø§Ù„Ø¨Ù†ÙƒÙŠØ©</p>
        </div>
        <button @click="openAccountModal()" class="px-6 py-3 bg-green-600 text-white rounded-xl font-bold hover:bg-green-700 transition flex items-center gap-2">
          <span>â•</span> Ø¥Ø¶Ø§ÙØ© Ø­Ø³Ø§Ø¨
        </button>
      </header>
      
      <div x-show="accounts.length === 0" class="bg-white rounded-2xl shadow-sm border border-gray-100 p-12 text-center">
        <div class="text-6xl mb-4">ğŸ¦</div>
        <h3 class="text-xl font-bold text-gray-900 mb-2">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ø³Ø§Ø¨Ø§Øª</h3>
        <p class="text-gray-600 mb-6">Ø£Ø¶Ù Ø­Ø³Ø§Ø¨Ø§ØªÙƒ Ø§Ù„Ø¨Ù†ÙƒÙŠØ© Ù„ØªØªØ¨Ø¹ Ø£Ø±ØµØ¯ØªÙƒ ÙˆØ¹Ù…Ù„ÙŠØ§ØªÙƒ Ø§Ù„Ù…Ø§Ù„ÙŠØ©</p>
        <button @click="openAccountModal()" class="px-6 py-3 bg-green-600 text-white rounded-xl font-bold hover:bg-green-700 transition shadow-lg">
          â• Ø¥Ø¶Ø§ÙØ© Ø£ÙˆÙ„ Ø­Ø³Ø§Ø¨
        </button>
      </div>
      
      <div x-show="accounts.length > 0" class="grid md:grid-cols-2 gap-6">
        <template x-for="account in accounts" :key="account.id || account.name">
          <div class="bg-gradient-to-br from-green-600 to-green-700 rounded-2xl shadow-lg p-6 text-white relative">
            <div class="absolute top-4 left-4 flex gap-2">
              <button @click="editAccount(account)" class="w-8 h-8 bg-white/20 hover:bg-white/30 rounded-lg flex items-center justify-center">
                âœï¸
              </button>
              <button @click="deleteAccount(account)" class="w-8 h-8 bg-white/20 hover:bg-white/30 rounded-lg flex items-center justify-center">
                ğŸ—‘ï¸
              </button>
            </div>
            <div class="flex justify-between items-start mb-4 pr-20">
              <div>
                <p class="text-lg font-bold mb-1" x-text="account.name">Ø§Ø³Ù… Ø§Ù„Ø­Ø³Ø§Ø¨</p>
                <p class="text-xs opacity-75" x-text="(account.type || 'Ø­Ø³Ø§Ø¨') + ' â€¢ ' + (account.bank || '')"></p>
              </div>
              <div class="text-2xl">
                <span x-show="account.type === 'Ø¨Ù†Ùƒ' || !account.type">ğŸ¦</span>
                <span x-show="account.type === 'Ø¨Ø·Ø§Ù‚Ø©'">ğŸ’³</span>
                <span x-show="account.type === 'Ù…Ø­ÙØ¸Ø©'">ğŸ‘›</span>
              </div>
            </div>
            
            <!-- Balance Display -->
            <div class="bg-white/10 rounded-xl p-4 mb-4">
              <p class="text-xs opacity-75 mb-1">Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ</p>
              <p class="text-2xl font-bold" x-text="formatMoney(account.balance || 0)">0.00 Ø±.Ø³</p>
              <p x-show="account.lastUpdate" class="text-xs opacity-60 mt-1" x-text="'Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: ' + formatDate(account.lastUpdate)"></p>
            </div>
            
            <div class="mb-2" x-show="account.number">
              <p class="text-xs opacity-75 mb-1">Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨</p>
              <p class="text-sm font-mono tracking-wider" x-text="account.number || ''">****</p>
            </div>
            <div class="flex gap-2 mt-4">
              <span x-show="account.isMine" class="px-2 py-1 bg-white/20 rounded text-xs">Ø­Ø³Ø§Ø¨ÙŠ</span>
              <span x-show="account.isInternal" class="px-2 py-1 bg-white/20 rounded text-xs">ØªØ­ÙˆÙŠÙ„ Ø¯Ø§Ø®Ù„ÙŠ</span>
            </div>
          </div>
        </template>
      </div>
    </div>

  </main>

  <!-- Add Transaction Modal -->
  <div x-show="showAddModal" @click.self="showAddModal = false" class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4" x-transition>
    <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full p-6" @click.stop>
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-xl font-bold text-gray-900">Ø¥Ø¶Ø§ÙØ© Ø¹Ù…Ù„ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©</h2>
        <button @click="showAddModal = false" class="text-gray-400 hover:text-gray-600">âœ•</button>
      </div>
      
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©</label>
          <div class="grid grid-cols-2 gap-3">
            <button @click="newTransaction.type = 'expense'" :class="newTransaction.type === 'expense' ? 'bg-red-500 text-white' : 'bg-gray-100 text-gray-700'" class="px-4 py-3 rounded-lg font-medium transition">
              ğŸ’¸ Ù…ØµØ±ÙˆÙ
            </button>
            <button @click="newTransaction.type = 'income'" :class="newTransaction.type === 'income' ? 'bg-green-500 text-white' : 'bg-gray-100 text-gray-700'" class="px-4 py-3 rounded-lg font-medium transition">
              ğŸ’° Ø¯Ø®Ù„
            </button>
          </div>
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ù…Ø¨Ù„Øº</label>
          <input type="number" x-model="newTransaction.amount" placeholder="0.00" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„ØªØ§Ø¬Ø± / Ø§Ù„ÙˆØµÙ</label>
          <input type="text" x-model="newTransaction.merchant" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…ØªØ¬Ø± Ø£Ùˆ ÙˆØµÙ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„ØªØµÙ†ÙŠÙ</label>
          <select x-model="newTransaction.category" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
            <template x-for="cat in categories" :key="cat">
              <option :value="cat" x-text="cat"></option>
            </template>
          </select>
        </div>
        
        <div class="flex gap-3 pt-4">
          <button @click="showAddModal = false" class="flex-1 px-6 py-3 border border-gray-300 rounded-lg font-medium text-gray-700 hover:bg-gray-50 transition">
            Ø¥Ù„ØºØ§Ø¡
          </button>
          <button @click="addTransaction()" class="flex-1 px-6 py-3 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition">
            âœ“ Ø¥Ø¶Ø§ÙØ©
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Budget Modal -->
  <div x-show="showBudgetModal" @click.self="showBudgetModal = false" class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4" x-transition>
    <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full p-6" @click.stop>
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-xl font-bold text-gray-900" x-text="editingBudget ? 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©' : 'Ø¥Ø¶Ø§ÙØ© Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©'">Ø¥Ø¶Ø§ÙØ© Ù…ÙŠØ²Ø§Ù†ÙŠØ©</h2>
        <button @click="showBudgetModal = false" class="text-gray-400 hover:text-gray-600">âœ•</button>
      </div>
      
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„ØªØµÙ†ÙŠÙ</label>
          <select x-model="newBudget.category" :disabled="editingBudget !== null" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent disabled:bg-gray-100">
            <option value="">Ø§Ø®ØªØ± Ø§Ù„ØªØµÙ†ÙŠÙ</option>
            <template x-for="cat in categories" :key="cat">
              <option :value="cat" x-text="cat"></option>
            </template>
          </select>
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ (SAR)</label>
          <input type="number" x-model="newBudget.limit" placeholder="0.00" step="0.01" min="0" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
        </div>
        
        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
          <p class="text-sm text-blue-800">
            ğŸ’¡ Ø³ÙŠØªÙ… ØªÙ†Ø¨ÙŠÙ‡Ùƒ Ø¹Ù†Ø¯Ù…Ø§ ØªØµÙ„ Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª Ø¥Ù„Ù‰ 80% Ù…Ù† Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰
          </p>
        </div>
        
        <div class="flex gap-3 pt-4">
          <button @click="showBudgetModal = false" class="flex-1 px-6 py-3 border border-gray-300 rounded-lg font-medium text-gray-700 hover:bg-gray-50 transition">
            Ø¥Ù„ØºØ§Ø¡
          </button>
          <button @click="addOrEditBudget()" class="flex-1 px-6 py-3 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition">
            âœ“ Ø­ÙØ¸
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Account Modal -->
  <div x-show="showAccountModal" class="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50" x-transition>
    <div @click.outside="showAccountModal = false" class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full p-6 max-h-[90vh] overflow-y-auto">
      <h3 class="text-xl font-bold text-gray-900 mb-6" x-text="editingAccount ? 'ØªØ¹Ø¯ÙŠÙ„ Ø­Ø³Ø§Ø¨' : 'Ø¥Ø¶Ø§ÙØ© Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯'">Ø¥Ø¶Ø§ÙØ© Ø­Ø³Ø§Ø¨</h3>
      
      <!-- AI Smart Extraction - Collapsible -->
      <div x-show="!editingAccount" class="mb-6">
        <button 
          @click="showAIExtraction = !showAIExtraction"
          class="w-full flex items-center justify-between p-4 bg-gradient-to-r from-purple-50 to-blue-50 rounded-xl border-2 border-purple-200 hover:border-purple-300 transition"
        >
          <div class="flex items-center gap-2">
            <span class="text-2xl">ğŸ¤–</span>
            <span class="font-bold text-purple-900">Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø°ÙƒÙŠ Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</span>
          </div>
          <span x-text="showAIExtraction ? 'â–¼' : 'â—€'" class="text-purple-600 font-bold"></span>
        </button>
        
        <div x-show="showAIExtraction" x-transition class="mt-3 p-4 bg-purple-50/50 rounded-xl border border-purple-100">
          <p class="text-sm text-purple-700 mb-3">Ø§Ù„ØµÙ‚ Ø±Ø³Ø§Ù„Ø© SMS Ù…Ù† Ø§Ù„Ø¨Ù†Ùƒ ÙˆØ³ÙŠÙ‚ÙˆÙ… Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</p>
          <textarea x-model="newAccount.smsText" placeholder="Ù…Ø«Ø§Ù„: ØªÙ… Ø§Ù„Ø´Ø±Ø§Ø¡ Ù…Ù† AMAZON Ø¨Ù…Ø¨Ù„Øº 299.00 SAR Ù…Ù† Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø±Ø§Ø¬Ø­ÙŠ **9767" rows="3" class="w-full px-4 py-3 border border-purple-300 rounded-lg focus:ring-2 focus:ring-purple-500 mb-3 text-sm"></textarea>
          <button @click="extractFromSMS()" class="w-full px-4 py-3 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-lg font-bold hover:from-purple-700 hover:to-blue-700 transition flex items-center justify-center gap-2">
            <span>âœ¨</span> Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø±Ø³Ø§Ù„Ø©
          </button>
        </div>
      </div>
      
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ø³Ù… Ø§Ù„Ø­Ø³Ø§Ø¨ *</label>
          <input type="text" x-model="newAccount.name" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ø±Ø§Ø¬Ø­ÙŠ 9767" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ù†ÙˆØ¹ *</label>
          <select x-model="newAccount.type" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
            <option value="Ø¨Ù†Ùƒ">Ø¨Ù†Ùƒ</option>
            <option value="Ø¨Ø·Ø§Ù‚Ø©">Ø¨Ø·Ø§Ù‚Ø©</option>
            <option value="Ù…Ø­ÙØ¸Ø©">Ù…Ø­ÙØ¸Ø© Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©</option>
          </select>
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨ / Ø¢Ø®Ø± 4 Ø£Ø±Ù‚Ø§Ù…</label>
          <input type="text" x-model="newAccount.number" placeholder="9767 Ø£Ùˆ 0305" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø¨Ù†Ùƒ / Ø§Ù„Ø¬Ù‡Ø©</label>
          <input type="text" x-model="newAccount.bank" placeholder="AlrajhiBank, STC Pay, Ø¥Ù„Ø®" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Ø£Ø³Ù…Ø§Ø¡ Ø¨Ø¯ÙŠÙ„Ø© (Ù…ÙØµÙˆÙ„Ø© Ø¨ÙØ§ØµÙ„Ø©)</label>
          <input type="text" x-model="newAccount.aliases" placeholder="Ø§Ù„Ø±Ø§Ø¬Ø­ÙŠ,alrajhi,alrajhi bank" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
        </div>
        
        <div class="flex gap-4">
          <label class="flex items-center gap-2 cursor-pointer">
            <input type="checkbox" x-model="newAccount.isMine" class="w-5 h-5 text-green-600 rounded">
            <span class="text-sm text-gray-700">Ø­Ø³Ø§Ø¨ÙŠ</span>
          </label>
          
          <label class="flex items-center gap-2 cursor-pointer">
            <input type="checkbox" x-model="newAccount.isInternal" class="w-5 h-5 text-green-600 rounded">
            <span class="text-sm text-gray-700">ØªØ­ÙˆÙŠÙ„ Ø¯Ø§Ø®Ù„ÙŠ</span>
          </label>
        </div>
        
        <div class="flex gap-3 pt-4">
          <button @click="showAccountModal = false" class="flex-1 px-6 py-3 border border-gray-300 rounded-lg font-medium text-gray-700 hover:bg-gray-50 transition">
            Ø¥Ù„ØºØ§Ø¡
          </button>
          <button @click="saveAccount()" class="flex-1 px-6 py-3 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition">
            âœ“ Ø­ÙØ¸
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast Notifications -->
  <div class="fixed top-4 left-4 z-50 space-y-2">
    <template x-for="toast in toasts" :key="toast.id">
      <div 
        x-transition:enter="transition ease-out duration-300"
        x-transition:enter-start="transform translate-x-full opacity-0"
        x-transition:enter-end="transform translate-x-0 opacity-100"
        x-transition:leave="transition ease-in duration-200"
        x-transition:leave-start="transform translate-x-0 opacity-100"
        x-transition:leave-end="transform translate-x-full opacity-0"
        class="px-6 py-4 rounded-xl shadow-lg flex items-center gap-3 min-w-[300px]"
        :class="toast.type === 'success' ? 'bg-green-600 text-white' : 'bg-red-600 text-white'"
      >
        <span x-text="toast.type === 'success' ? 'âœ“' : 'âœ•'" class="text-2xl"></span>
        <span x-text="toast.message" class="font-medium"></span>
      </div>
    </template>
  </div>

  <!-- Edit Transaction Modal -->
  <div x-show="showEditTransactionModal" class="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50" x-transition>
    <div @click.outside="showEditTransactionModal = false" class="bg-white rounded-2xl shadow-2xl max-w-md w-full p-6">
      <h3 class="text-xl font-bold text-gray-900 mb-6">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©</h3>
      
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„ØªØ§Ø¬Ø± *</label>
          <input type="text" x-model="newTransaction.merchant" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500">
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ù…Ø¨Ù„Øº *</label>
          <input type="number" step="0.01" x-model="newTransaction.amount" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500">
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„ØªØµÙ†ÙŠÙ</label>
          <select x-model="newTransaction.category" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500">
            <template x-for="cat in categories" :key="cat">
              <option :value="cat" x-text="cat"></option>
            </template>
          </select>
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
          <textarea x-model="newTransaction.notes" rows="2" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500"></textarea>
        </div>
        
        <div class="flex gap-3 pt-4">
          <button @click="showEditTransactionModal = false" class="flex-1 px-6 py-3 border border-gray-300 rounded-lg font-medium text-gray-700 hover:bg-gray-50">
            Ø¥Ù„ØºØ§Ø¡
          </button>
          <button @click="saveEditedTransaction()" class="flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700">
            Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Privacy Policy Modal -->
  <div x-show="showPrivacyModal" x-cloak class="fixed inset-0 z-50 overflow-y-auto" style="background: rgba(0,0,0,0.5);">
    <div class="flex items-center justify-center min-h-screen p-4">
      <div @click.away="showPrivacyModal = false" class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[80vh] overflow-y-auto">
        <div class="sticky top-0 bg-white border-b border-gray-200 p-6 flex items-center justify-between">
          <h2 class="text-2xl font-bold text-gray-900">ğŸ”’ Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©</h2>
          <button @click="showPrivacyModal = false" class="text-gray-400 hover:text-gray-600">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>
        
        <div class="p-6 space-y-4 text-right">
          <div>
            <h3 class="font-bold text-lg text-gray-900 mb-2">ğŸ“Š Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h3>
            <p class="text-gray-700">Ù†Ø­Ù† Ù†Ø¬Ù…Ø¹ ÙÙ‚Ø· Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙŠ ØªØ¯Ø®Ù„Ù‡Ø§ Ø¨Ù†ÙØ³Ùƒ: Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©ØŒ Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ§ØªØŒ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§ØªØŒ ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª.</p>
          </div>
          
          <div>
            <h3 class="font-bold text-lg text-gray-900 mb-2">ğŸ” ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h3>
            <p class="text-gray-700">Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù…Ø®Ø²Ù†Ø© ÙÙŠ Ø¬Ø¯Ø§ÙˆÙ„ Google Sheets Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ. Ù†Ø­Ù† Ù„Ø§ Ù†Ø®Ø²Ù† Ø£ÙŠ Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù„Ù‰ Ø®ÙˆØ§Ø¯Ù… Ø®Ø§Ø±Ø¬ÙŠØ©.</p>
          </div>
          
          <div>
            <h3 class="font-bold text-lg text-gray-900 mb-2">ğŸ¤– Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</h3>
            <p class="text-gray-700">Ù†Ø³ØªØ®Ø¯Ù… GROQ API Ùˆ Gemini Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù†ØµÙŠØ© ÙˆØ§Ø³ØªØ®Ø±Ø§Ø¬ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª. ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ù†Øµ Ø§Ù„Ø±Ø³Ø§Ù„Ø© ÙÙ‚Ø·ØŒ Ø¯ÙˆÙ† Ø£ÙŠ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø´Ø®ØµÙŠØ©.</p>
          </div>
          
          <div>
            <h3 class="font-bold text-lg text-gray-900 mb-2">ğŸ“± Telegram Bot</h3>
            <p class="text-gray-700">Ø¥Ø°Ø§ Ù‚Ù…Øª Ø¨ØªÙØ¹ÙŠÙ„ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª TelegramØŒ Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø¥Ù„Ù‰ Ø±Ù‚Ù… Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯. Ù„Ø§ Ù†Ø´Ø§Ø±Ùƒ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù…Ø¹ Ø£Ø·Ø±Ø§Ù Ø«Ø§Ù„Ø«Ø©.</p>
          </div>
          
          <div>
            <h3 class="font-bold text-lg text-gray-900 mb-2">ğŸ—‘ï¸ Ø­Ø°Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h3>
            <p class="text-gray-700">ÙŠÙ…ÙƒÙ†Ùƒ Ø­Ø°Ù Ø­Ø³Ø§Ø¨Ùƒ ÙˆØ¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ ÙÙŠ Ø£ÙŠ ÙˆÙ‚Øª Ù…Ù† ØµÙØ­Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª. Ø§Ù„Ø­Ø°Ù Ù†Ù‡Ø§Ø¦ÙŠ ÙˆÙ„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡.</p>
          </div>
          
          <div>
            <h3 class="font-bold text-lg text-gray-900 mb-2">ğŸ”’ Ø§Ù„Ø£Ù…Ø§Ù†</h3>
            <p class="text-gray-700">Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙŠØ¹Ù…Ù„ Ø¹Ù„Ù‰ Google Apps Script Ù…Ø¹ Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„ HTTPS. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù…ÙŠØ© Ø¨Ù†Ø¸Ø§Ù… Ø£Ù…Ø§Ù† Google.</p>
          </div>
          
          <div class="border-t border-gray-200 pt-4 mt-4">
            <p class="text-sm text-gray-600">Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: ÙŠÙ†Ø§ÙŠØ± 2026</p>
            <p class="text-sm text-gray-600 mt-2">Ù„Ù„Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª: <a href="mailto:support@sjatracker.com" class="text-green-600 hover:underline">support@sjatracker.com</a></p>
          </div>
          
          <button @click="showPrivacyModal = false" class="w-full px-6 py-3 bg-green-600 text-white rounded-lg font-bold hover:bg-green-700 transition">
            ÙÙ‡Ù…Øª
          </button>
        </div>
      </div>
    </div>
  </div>

</body>
</html>
